{"paragraphs":[{"text":"%md\n#### This notebook reads the JSON contracts file and extracts information into data frame","user":"anonymous","dateUpdated":"2023-05-23T11:41:02+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>This notebook reads the JSON contracts file and extracts information into data frame</h4>\n"}]},"apps":[],"jobName":"paragraph_1684833577310_-232481234","id":"20230523-111937_33789328","dateCreated":"2023-05-23T11:19:37+0200","dateStarted":"2023-05-23T11:41:02+0200","dateFinished":"2023-05-23T11:41:02+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1524"},{"text":"%spark\nimport org.apache.spark.sql.{SparkSession, DataFrame}\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport java.sql.Timestamp\nimport java.text.SimpleDateFormat","user":"anonymous","dateUpdated":"2023-05-23T11:21:01+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.{SparkSession, DataFrame}\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport java.sql.Timestamp\nimport java.text.SimpleDateFormat"}]},"apps":[],"jobName":"paragraph_1684507544849_-1616495895","id":"20230519-164544_63636390","dateCreated":"2023-05-19T16:45:44+0200","dateStarted":"2023-05-23T11:21:01+0200","dateFinished":"2023-05-23T11:21:03+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1525"},{"text":"%md\n###Extract and Transformation of **contracts** \n","user":"anonymous","dateUpdated":"2023-05-23T11:23:22+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Extract and Transformation of <strong>contracts</strong></h3>\n"}]},"apps":[],"jobName":"paragraph_1684833785438_-20554581","id":"20230523-112305_641822902","dateCreated":"2023-05-23T11:23:05+0200","dateStarted":"2023-05-23T11:23:22+0200","dateFinished":"2023-05-23T11:23:22+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1526"},{"text":"%spark\nval contractsPathRaw = \"/user/training/adriana/raw/contratos/contracts.json\"\nval contractsDF = spark.read.option(\"header\",\"true\").option(\"inferSchema\",\"true\").json(contractsPathRaw) ","user":"anonymous","dateUpdated":"2023-05-23T11:22:22+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"contractsPathRaw: String = /user/training/adriana/raw/contratos/contracts.json\ncontractsDF: org.apache.spark.sql.DataFrame = [contract_date: string, contract_number: string ... 7 more fields]"}]},"apps":[],"jobName":"paragraph_1684492094614_-1404990869","id":"20230519-122814_700705418","dateCreated":"2023-05-19T12:28:14+0200","dateStarted":"2023-05-23T11:22:22+0200","dateFinished":"2023-05-23T11:22:25+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1527"},{"text":"%spark\ncontractsDF.printSchema","user":"anonymous","dateUpdated":"2023-05-23T11:22:19+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- contract_date: string (nullable = true)\n |-- contract_number: string (nullable = true)\n |-- cups: string (nullable = true)\n |-- discount: boolean (nullable = true)\n |-- fiscal_address: struct (nullable = true)\n |    |-- city: string (nullable = true)\n |    |-- country: string (nullable = true)\n |    |-- street: string (nullable = true)\n |    |-- zip_code: string (nullable = true)\n |-- id: string (nullable = true)\n |-- personal_data: struct (nullable = true)\n |    |-- address: struct (nullable = true)\n |    |    |-- city: string (nullable = true)\n |    |    |-- country: string (nullable = true)\n |    |    |-- street: string (nullable = true)\n |    |    |-- zip_code: string (nullable = true)\n |    |-- email: string (nullable = true)\n |    |-- first_name: string (nullable = true)\n |    |-- last_name: string (nullable = true)\n |    |-- phone: string (nullable = true)\n |-- product: struct (nullable = true)\n |    |-- code: string (nullable = true)\n |    |-- description: string (nullable = true)\n |    |-- id: long (nullable = true)\n |-- status: string (nullable = true)"}]},"apps":[],"jobName":"paragraph_1684508637759_1161557818","id":"20230519-170357_1520373876","dateCreated":"2023-05-19T17:03:57+0200","dateStarted":"2023-05-23T11:22:19+0200","dateFinished":"2023-05-23T11:22:21+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1528"},{"text":"%spark\ncontractsDF.show(false)","user":"anonymous","dateUpdated":"2023-05-23T11:22:36+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------------+---------------+----------------------+--------+----------------------------------------------------------------------------------+----------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------+--------+\n|contract_date          |contract_number|cups                  |discount|fiscal_address                                                                    |id                                      |personal_data                                                                                                                                           |product                                |status  |\n+-----------------------+---------------+----------------------+--------+----------------------------------------------------------------------------------+----------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------+--------+\n|Jan 18, 2018 8:31:14 PM|00318293       |ES0022000004043566WS1P|false   |[Jerez de la Frontera, España, Poblado Ernesto, 45, 26533]                        |1b009a4526c52ac2a10c8f6f4a2c26968a717902|[[Zamora, España, Edificio Micaela s/n. Esc. 082, 49902], reina.garica.dummy@hotmail.com, Reina, Garica, 682172294]                                     |[ELECT_FIJO, Electricidad Fijo, 1]     |ACTIVO  |\n|Jan 19, 2018 1:22:28 PM|00487531       |ES0022000008244877WP1P|false   |[Segovia, España, Riera Ana María Munguía, 5, 77297]                              |9c901ea5b4b716455fa2a0cbae03b8df8fffb563|[[Granada, España, Monte Pedro, 4, 41777], benito.chapa.dummy@hotmail.com, Benito, Chapa, 654.614.487]                                                  |[ELECT_FIJO, Electricidad Fijo, 1]     |INACTIVO|\n|Jan 30, 2018 8:31:54 PM|00912523       |ES0022000008245434AJ1P|true    |[Santa Coloma de Gramanet, España, Escalinata Mónica Gómez s/n. Puerta 409, 14162]|3d0aa1b5b11b41cb3ed916cb0aafec2a27d3e642|[[Benalmádena, España, Partida María Cristina Castillo, 74 Esc. 594, 79380], ester.burgos.dummy@hotmail.com, Ester, Burgos, 610 526 879]                |[ELECT_VIP, , 3]                       |ACTIVO  |\n|Jan 14, 2018 9:31:17 PM|00678073       |ES0022000004039742CD1P|true    |[Sanlúcar de Barrameda, España, Ronda Claudia Gutiérrez s/n., 50524]              |34a54d5ec535aa040bfc4360970e7c5cc2499598|[[Ciudad Real, España, Ronda Daniela Roque, 18, 09417], carlota.lovato.dummy@gmail.com, Carlota, Lovato, 663 602 518]                                   |[ELECT_FLEXI, Electricidad Flexible, 2]|ACTIVO  |\n|Jan 13, 2018 8:11:46 AM|00547151       |ES0022000004041193ZB1P|false   |[Dos Hermanas, España, Salida Juan Salcedo 12, 48435]                             |c97c93fa9a12214526313389f1ed8176dc8fd8bc|[[Chiclana de la Frontera, España, Muelle Ana s/n., 40545], horacio.vanegas.dummy@gmail.com, Horacio, Vanegas, 655029748]                               |[ELECT_FIJO, Electricidad Fijo, 1]     |INACTIVO|\n|Jan 7, 2018 5:37:47 AM |00067996       |ES0022000004002288RE1P|false   |[Mataró, España, Caserio Victoria s/n., 13813]                                    |76446b8d6a56e2baca4cd0dc4c690db04db33bed|[[Orense, España, Glorieta Emilia, 15 Esc. 379, 77824], pedro.negron.dummy@gmail.com, Pedro, Negrón, 653.209.065]                                       |[ELECT_FIJO, Electricidad Fijo, 1]     |INACTIVO|\n|Jan 12, 2018 8:14:21 AM|00770228       |ES0022000004387917RX1P|false   |[Sanlúcar de Barrameda, España, Extramuros María Cristina 3 Esc. 604, 00303]      |5b3aa04830e535dd97eb31a44f997840819e1b09|[[Vitoria, España, Salida Miguel Ángel Núñez, 1 Puerta 708, 51298], victor.zuniga.dummy@gmail.com, Víctor, Zúñiga, 604-051-602]                         |[ELECT_VIP, , 3]                       |ACTIVO  |\n|Jan 31, 2018 3:32:25 AM|00579150       |ES0022000004388411EK1P|false   |[Mijas, España, Subida Nicolás 2 Esc. 905, 14078]                                 |5215c5b0cf85181dae03d9e6323821c0c3de8d9e|[[Elda, España, Ronda María Teresa s/n., 16961], diego.herrera.dummy@yahoo.com, Diego, Herrera, 643-009-736]                                            |[ELECT_FIJO, Electricidad Fijo, 1]     |ACTIVO  |\n|Jan 3, 2018 3:40:27 PM |00037160       |ES0022000004388883CX1P|false   |[Roquetas de Mar, España, Rambla Jorge Calderón 6 Esc. 590, 75035]                |51d2b3c68b6aef642693c12ec400aa6f20e6541e|[[Majadahonda, España, Extrarradio Leonor Navarrete 17 Esc. 819, 84703], jorge luis.carrasquillo.dummy@yahoo.com, Jorge Luis, Carrasquillo, 630-059-638]|[ELECT_FLEXI, Electricidad Flexible, 2]|ACTIVO  |\n|Jan 11, 2018 6:24:53 AM|00163486       |ES0022000004389140PZ1P|false   |[Huelva, España, Municipio Olivia, 78 Puerta 733, 09527]                          |cb7aeae1a951c9fcdd385988878098e013c5e7ba|[[Sagunto, España, Paseo Susana Tejada 1, 30240], rosalia.delgado.dummy@hotmail.com, Rosalia, Delgado, 683790888]                                       |[ELECT_VIP, , 3]                       |ACTIVO  |\n|Jan 28, 2018 2:55:39 PM|00041712       |ES0022000004389889HG1P|true    |[Cartagena, España, Poblado Gabriela 7, 30359]                                    |38ecd8e574141cc1b4c423f8a874acdf882692b7|[[Bilbao, España, Jardines Homero, 54 Esc. 037, 35487], esteban.cuellar.dummy@hotmail.com, Esteban, Cuellar, 639-791-307]                               |[ELECT_FLEXI, Electricidad Flexible, 2]|ACTIVO  |\n|Jan 12, 2018 5:59:58 AM|00687884       |ES0022000004005395ER1P|true    |[Salamanca, España, Poblado Gabriela s/n., 66053]                                 |11e34478099e4da2007b7f6f1ec4e86a9f24956a|[[Móstoles, España, Rua Samuel 0, 60900], magdalena.cavazos.dummy@hotmail.com, Magdalena, Cavazos, 687-713-434]                                         |[ELECT_VIP, , 3]                       |ACTIVO  |\n|Jan 12, 2018 2:45:16 PM|00762187       |ES0022000008244616ZT1P|true    |[Mataró, España, Sección Jorge s/n. Esc. 039, 41275]                              |3168759f6e76b394295d2bfa0ea0d3acea2affc0|[[Collado Villalba, España, Poblado Luis Miguel Montaño 5, 28027], beatriz.portillo.dummy@yahoo.com, Beatriz, Portillo, 642057615]                      |[ELECT_VIP, , 3]                       |ACTIVO  |\n|Jan 7, 2018 4:05:39 PM |00076659       |ES0022000004388469WX1P|false   |[Santander, España, Huerta Francisco Almanza 7, 75134]                            |1b0afa29cde0e870b391ade43d6cd9dce9b39da1|[[Barcelona, España, Quinta Cristina Atencio 43, 04262], marilu.negrete.dummy@yahoo.com, Marilu, Negrete, 658 760 431]                                  |[ELECT_FLEXI, Electricidad Flexible, 2]|ACTIVO  |\n|Jan 12, 2018 7:32:21 PM|00804404       |ES0022000004389727BA1P|true    |[Las Palmas de Gran Canaria, España, Masía Elisa 0 Puerta 830, 26068]             |3064b2b77a5a52f2ab4f5a3b8fd5496ea4a8ce4b|[[León, España, Vía Pública Guillermina, 60, 69999], jorge luis.candelaria.dummy@hotmail.com, Jorge Luis, Candelaria, 635920385]                        |[ELECT_FIJO, Electricidad Fijo, 1]     |ACTIVO  |\n|Jan 8, 2018 1:55:19 PM |00324155       |ES0022000004041257VY1P|true    |[Sanlúcar de Barrameda, España, Rampa Marco Antonio, 2 Puerta 948, 08643]         |4369666f4320dbd95ec82bd33f87947b9a0dddff|[[Talavera de la Reina, España, Barranco María Elena Leal 1, 55535], jose.mota.dummy@gmail.com, José, Mota, 683.115.992]                                |[ELECT_FIJO, Electricidad Fijo, 1]     |ACTIVO  |\n|Jan 25, 2018 5:18:07 PM|00602740       |ES0022000004041352KD1P|true    |[Valladolid, España, Parcela Débora 8, 89469]                                     |7b93d8b7c7eb2cbe2b4798bad5eca9df1aa84b67|[[Palencia, España, Vía Pública Sergio Esquibel 3, 47643], guillermo.espinal.dummy@yahoo.com, Guillermo, Espinal, 686 062 852]                          |[ELECT_FIJO, Electricidad Fijo, 1]     |ACTIVO  |\n|Jan 21, 2018 2:26:24 AM|00392460       |ES0022000004042399CK1P|true    |[Valdemoro, España, Calleja Inés 3 Esc. 726, 69850]                               |a36a301d7cdefc935f3886ce30c0c351d593cfda|[[Irún, España, Senda César 83 Esc. 815, 55732], silvia.trujillo.dummy@yahoo.com, Silvia, Trujillo, 686285663]                                          |[ELECT_VIP, , 3]                       |INACTIVO|\n|Jan 3, 2018 12:32:08 PM|00193239       |ES0022000004001831MW1P|true    |[Coslada, España, Municipio Patricio 6, 74220]                                    |e9472a41af06f550af71533dbfe88270fd367c97|[[El Ejido, España, Aldea Manuel Mateo, 1 Puerta 267, 12866], juan.carrera.dummy@hotmail.com, Juan, Carrera, 696 477 795]                               |[ELECT_FLEXI, Electricidad Flexible, 2]|ACTIVO  |\n|Jan 14, 2018 8:05:38 PM|00490167       |ES0022000004003312TB1P|false   |[Calahorra, España, Grupo Antonio Pabón s/n. Puerta 816, 32599]                   |544142285a336a9e6fdfbc7e4df2d80166c2e6bd|[[Guadalajara, España, Arroyo Fernando Sosa, 36, 38283], octavio.mireles.dummy@gmail.com, Octavio, Mireles, 630-812-089]                                |[ELECT_VIP, , 3]                       |INACTIVO|\n+-----------------------+---------------+----------------------+--------+----------------------------------------------------------------------------------+----------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------+--------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1684500394866_1283280557","id":"20230519-144634_140422684","dateCreated":"2023-05-19T14:46:34+0200","dateStarted":"2023-05-23T11:22:36+0200","dateFinished":"2023-05-23T11:22:37+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1529"},{"text":"%spark\n//check for duplicates\ncontractsDF.count()\ncontractsDF.dropDuplicates().count()\n","user":"anonymous","dateUpdated":"2023-05-23T11:24:17+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res165: Long = 6482\nres166: Long = 6482"}]},"apps":[],"jobName":"paragraph_1684509488969_240986766","id":"20230519-171808_1150100596","dateCreated":"2023-05-19T17:18:08+0200","dateStarted":"2023-05-23T11:24:17+0200","dateFinished":"2023-05-23T11:24:22+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1530"},{"text":"%spark\n//convertDateFormat receives a string date, saves it in the form \"MMM dd, yyyy hh:mm:ss a\" and returns it in \"yyyyMMdd\" format\n//convertDateFormatUDF transforms the convertDateFormat function into UDF","user":"anonymous","dateUpdated":"2023-05-23T12:03:54+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1684833887405_562445203","id":"20230523-112447_612953567","dateCreated":"2023-05-23T11:24:47+0200","dateStarted":"2023-05-23T12:03:00+0200","dateFinished":"2023-05-23T12:03:01+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1531"},{"text":"%spark\ndef convertDateFormat(date: String) : String = {\n  val inputDate = new java.text.SimpleDateFormat(\"MMM dd, yyyy hh:mm:ss a\")\n  val outputDate = new java.text.SimpleDateFormat(\"yyyyMMdd\")\n  val newDate = inputDate.parse(date)\n  outputDate.format(newDate)\n}\n\nval convertDateFormatUDF = udf(convertDateFormat _)\n\n","user":"anonymous","dateUpdated":"2023-05-23T11:32:16+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"convertDateFormat: (date: String)String\nconvertDateFormatUDF: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))"}]},"apps":[],"jobName":"paragraph_1684494149988_1398558647","id":"20230519-130229_1645842942","dateCreated":"2023-05-19T13:02:29+0200","dateStarted":"2023-05-23T11:32:16+0200","dateFinished":"2023-05-23T11:32:20+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1532"},{"text":"%spark\n//contractsFinalDF does:\n//Apply the convertDateFormatUDF to the 'contract_date' column. Some columns are renamed according to the project convention ","user":"anonymous","dateUpdated":"2023-05-23T11:37:32+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1684834348725_1561719593","id":"20230523-113228_1418505026","dateCreated":"2023-05-23T11:32:28+0200","dateStarted":"2023-05-23T11:37:32+0200","dateFinished":"2023-05-23T11:37:33+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1533"},{"text":"%spark\nval contractsFinalDF = (contractsDF.select($\"id\", $\"contract_number\" as \"numcontrato\", $\"cups\", convertDateFormatUDF($\"contract_date\")  as \"fcontrato\", \n                                           $\"status\", $\"discount\", $\"personal_data.first_name\", $\"personal_data.last_name\", $\"personal_data.email\", $\"personal_data.phone\", \n                                           $\"personal_data.address.country\" as \"country\", $\"personal_data.address.city\" as \"city\", $\"personal_data.address.street\" as \"street\", \n                                           $\"personal_data.address.zip_code\" as \"codpostal\", $\"fiscal_address.country\" as \"fiscal_country\", $\"fiscal_address.city\" as \"fiscal_city\",\n                                           $\"fiscal_address.street\"  as \"fiscal_street\", $\"fiscal_address.zip_code\" as \"fiscal_codpostal\", $\"product.id\"  as \"id_product\",\n                                           $\"product.code\" as \"codproducto\", $\"product.description\"))\ncontractsFinalDF.show(5, false)\n","user":"anonymous","dateUpdated":"2023-05-23T11:37:35+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"contractsFinalDF: org.apache.spark.sql.DataFrame = [id: string, numcontrato: string ... 19 more fields]\n+----------------------------------------+-----------+----------------------+---------+--------+--------+----------+---------+-------------------------------+-----------+-------+-----------------------+--------------------------------------------+---------+--------------+------------------------+---------------------------------------+----------------+----------+-----------+---------------------+\n|id                                      |numcontrato|cups                  |fcontrato|status  |discount|first_name|last_name|email                          |phone      |country|city                   |street                                      |codpostal|fiscal_country|fiscal_city             |fiscal_street                          |fiscal_codpostal|id_product|codproducto|description          |\n+----------------------------------------+-----------+----------------------+---------+--------+--------+----------+---------+-------------------------------+-----------+-------+-----------------------+--------------------------------------------+---------+--------------+------------------------+---------------------------------------+----------------+----------+-----------+---------------------+\n|1b009a4526c52ac2a10c8f6f4a2c26968a717902|00318293   |ES0022000004043566WS1P|20180118 |ACTIVO  |false   |Reina     |Garica   |reina.garica.dummy@hotmail.com |682172294  |España |Zamora                 |Edificio Micaela s/n. Esc. 082              |49902    |España        |Jerez de la Frontera    |Poblado Ernesto, 45                    |26533           |1         |ELECT_FIJO |Electricidad Fijo    |\n|9c901ea5b4b716455fa2a0cbae03b8df8fffb563|00487531   |ES0022000008244877WP1P|20180119 |INACTIVO|false   |Benito    |Chapa    |benito.chapa.dummy@hotmail.com |654.614.487|España |Granada                |Monte Pedro, 4                              |41777    |España        |Segovia                 |Riera Ana María Munguía, 5             |77297           |1         |ELECT_FIJO |Electricidad Fijo    |\n|3d0aa1b5b11b41cb3ed916cb0aafec2a27d3e642|00912523   |ES0022000008245434AJ1P|20180130 |ACTIVO  |true    |Ester     |Burgos   |ester.burgos.dummy@hotmail.com |610 526 879|España |Benalmádena            |Partida María Cristina Castillo, 74 Esc. 594|79380    |España        |Santa Coloma de Gramanet|Escalinata Mónica Gómez s/n. Puerta 409|14162           |3         |ELECT_VIP  |                     |\n|34a54d5ec535aa040bfc4360970e7c5cc2499598|00678073   |ES0022000004039742CD1P|20180114 |ACTIVO  |true    |Carlota   |Lovato   |carlota.lovato.dummy@gmail.com |663 602 518|España |Ciudad Real            |Ronda Daniela Roque, 18                     |09417    |España        |Sanlúcar de Barrameda   |Ronda Claudia Gutiérrez s/n.           |50524           |2         |ELECT_FLEXI|Electricidad Flexible|\n|c97c93fa9a12214526313389f1ed8176dc8fd8bc|00547151   |ES0022000004041193ZB1P|20180113 |INACTIVO|false   |Horacio   |Vanegas  |horacio.vanegas.dummy@gmail.com|655029748  |España |Chiclana de la Frontera|Muelle Ana s/n.                             |40545    |España        |Dos Hermanas            |Salida Juan Salcedo 12                 |48435           |1         |ELECT_FIJO |Electricidad Fijo    |\n+----------------------------------------+-----------+----------------------+---------+--------+--------+----------+---------+-------------------------------+-----------+-------+-----------------------+--------------------------------------------+---------+--------------+------------------------+---------------------------------------+----------------+----------+-----------+---------------------+\nonly showing top 5 rows"}]},"apps":[],"jobName":"paragraph_1684511787882_-271444764","id":"20230519-175627_1229588953","dateCreated":"2023-05-19T17:56:27+0200","dateStarted":"2023-05-23T11:37:35+0200","dateFinished":"2023-05-23T11:37:37+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1534"},{"text":"%md\n###Data dump in parquet format in HDFS\n","user":"anonymous","dateUpdated":"2023-05-23T11:37:55+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Data dump in parquet format in HDFS</h3>\n"}]},"apps":[],"jobName":"paragraph_1684834662628_1410728861","id":"20230523-113742_1170226213","dateCreated":"2023-05-23T11:37:42+0200","dateStarted":"2023-05-23T11:37:55+0200","dateFinished":"2023-05-23T11:37:55+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1535"},{"text":"%spark\nval contractsPathRefined = \"/user/training/adriana/refined/Contracts/\"","user":"anonymous","dateUpdated":"2023-05-23T11:39:24+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"contractsPathRefined: String = /user/training/adriana/refined/Contracts/"}]},"apps":[],"jobName":"paragraph_1684508173723_-1961761842","id":"20230519-165613_1477142352","dateCreated":"2023-05-19T16:56:13+0200","dateStarted":"2023-05-23T11:39:24+0200","dateFinished":"2023-05-23T11:39:25+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1536"},{"text":"%spark\ncontractsFinalDF.write.format(\"parquet\").mode(\"overwrite\").save(contractsPathRefined)\n","user":"anonymous","dateUpdated":"2023-05-23T11:39:39+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1684508169723_-669281341","id":"20230519-165609_507368895","dateCreated":"2023-05-19T16:56:09+0200","dateStarted":"2023-05-23T11:39:39+0200","dateFinished":"2023-05-23T11:39:41+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1537"},{"text":"%spark\n","user":"anonymous","dateUpdated":"2023-05-23T11:40:47+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1684834731393_-1028296860","id":"20230523-113851_1315815245","dateCreated":"2023-05-23T11:38:51+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1538"}],"name":"Caso_practico/silver/ETL_contracts","id":"2J32YNSNE","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}