{"paragraphs":[{"text":"%md\n###Creation of query tables (sips and sipsco) for all electrical distributors","user":"anonymous","dateUpdated":"2023-05-23T12:10:39+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Creation of query tables (sips and sipsco) for all electrical distributors</h3>\n"}]},"apps":[],"jobName":"paragraph_1684693411745_1006652725","id":"20230521-202331_583655727","dateCreated":"2023-05-21T20:23:31+0200","dateStarted":"2023-05-23T12:10:39+0200","dateFinished":"2023-05-23T12:10:39+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4163"},{"text":"%spark\nimport org.apache.spark.sql.{SparkSession, DataFrame}\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\n\nimport java.sql.Timestamp\nimport java.text.SimpleDateFormat","user":"anonymous","dateUpdated":"2023-05-22T22:26:55+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.{SparkSession, DataFrame}\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport java.sql.Timestamp\nimport java.text.SimpleDateFormat"}]},"apps":[],"jobName":"paragraph_1684348206625_-704575223","id":"20230517-171908_773654754","dateCreated":"2023-05-17T20:30:06+0200","dateStarted":"2023-05-22T22:27:18+0200","dateFinished":"2023-05-22T22:27:21+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4164"},{"text":"%spark\n//parquet file paths\nval cnmcSipscoDF = spark.read.parquet(\"/user/training/adriana/refined/Cnmc_consumption\")\nval cnmcSipsDF = spark.read.parquet(\"/user/training/adriana/refined/Cnmc_ps\")\nval contractsDF = spark.read.parquet(\"/user/training/adriana/refined/Contracts\")\nval viesgoBegasaSipscoDF = spark.read.parquet(\"/user/training/adriana/refined/Viesgo_Begasa_consumption/\")\nval viesgoBegasaSipsDF = spark.read.parquet(\"/user/training/adriana/refined/Viesgo_Begasa_ps/\")\n\n","user":"anonymous","dateUpdated":"2023-05-23T11:54:34+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cnmcSipscoDF: org.apache.spark.sql.DataFrame = [cups: string, finicio: timestamp ... 22 more fields]\ncnmcSipsDF: org.apache.spark.sql.DataFrame = [coddist: string, cups: string ... 55 more fields]\ncontractsDF: org.apache.spark.sql.DataFrame = [id: string, numcontrato: string ... 19 more fields]\nviesgoBegasaSipscoDF: org.apache.spark.sql.DataFrame = [cups: string, anio_facturacion: int ... 8 more fields]\nviesgoBegasaSipsDF: org.apache.spark.sql.DataFrame = [cups: string, distribuidora: string ... 37 more fields]"}]},"apps":[],"jobName":"paragraph_1684348206635_926359248","id":"20230517-183705_2114527419","dateCreated":"2023-05-17T20:30:06+0200","dateStarted":"2023-05-23T11:54:35+0200","dateFinished":"2023-05-23T11:54:39+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4165"},{"text":"%md\n###Definition of UDFs","user":"anonymous","dateUpdated":"2023-05-23T11:55:46+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Definition of UDFs</h3>\n"}]},"apps":[],"jobName":"paragraph_1684693741881_-303146751","id":"20230521-202901_1842434729","dateCreated":"2023-05-21T20:29:01+0200","dateStarted":"2023-05-23T11:55:46+0200","dateFinished":"2023-05-23T11:55:46+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4166"},{"text":"%spark\n//nmDays calculate the difference between two dates (in milliseconds) and divide by 86400000 to convert to days\n//numDaysUDF transforms the numDays function into UDF\ndef numDays(date1: Timestamp, date2: Timestamp) : Int =  ((date2.getTime - date1.getTime)/86400000).toInt\nval numDaysUDF = udf(numDays _ )","user":"anonymous","dateUpdated":"2023-05-23T12:04:37+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"numDays: (date1: java.sql.Timestamp, date2: java.sql.Timestamp)Int\nnumDaysUDF: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function2>,IntegerType,Some(List(TimestampType, TimestampType)))"}]},"apps":[],"jobName":"paragraph_1684348723554_-162030362","id":"20230517-203843_638210486","dateCreated":"2023-05-17T20:38:43+0200","dateStarted":"2023-05-23T12:04:37+0200","dateFinished":"2023-05-23T12:04:39+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4167"},{"text":"%spark\n//cmd calculates the daily consumption as the sum of 6 parameters divided by the number of days\n//cmdUDF transforms the cmd function into UDF\ndef cmd(cons1: Float, cons2: Float, cons3: Float, cons4: Float, cons5: Float, cons6: Float, days: Int) : Float =  (cons1 + cons2 + cons3 + cons4 + cons5 + cons6)/days\nval cmdUDF = udf(cmd _ )","user":"anonymous","dateUpdated":"2023-05-23T12:10:16+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cmd: (cons1: Float, cons2: Float, cons3: Float, cons4: Float, cons5: Float, cons6: Float, days: Int)Float\ncmdUDF: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function7>,FloatType,Some(List(FloatType, FloatType, FloatType, FloatType, FloatType, FloatType, IntegerType)))"}]},"apps":[],"jobName":"paragraph_1684348736986_-1563906916","id":"20230517-203856_1118840732","dateCreated":"2023-05-17T20:38:56+0200","dateStarted":"2023-05-23T12:10:16+0200","dateFinished":"2023-05-23T12:10:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4168"},{"text":"%md\n###Tables for CNMC\n","user":"anonymous","dateUpdated":"2023-05-23T12:10:32+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Tables for CNMC</h3>\n"}]},"apps":[],"jobName":"paragraph_1684694449992_1419730768","id":"20230521-204049_771147362","dateCreated":"2023-05-21T20:40:49+0200","dateStarted":"2023-05-23T12:10:32+0200","dateFinished":"2023-05-23T12:10:32+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4169"},{"text":"%md\n####Sipsco","user":"anonymous","dateUpdated":"2023-05-23T12:10:57+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Sipsco</h4>\n"}]},"apps":[],"jobName":"paragraph_1684693774617_-397440829","id":"20230521-202934_801652894","dateCreated":"2023-05-21T20:29:34+0200","dateStarted":"2023-05-23T12:10:57+0200","dateFinished":"2023-05-23T12:10:57+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4170"},{"text":"%spark\n//cnmcSipscoFinalDF does:\n//Change the date format to \"yyyyMMdd\" with date_format\n//Apply the numDays and cmdUDF to respective columns ","user":"anonymous","dateUpdated":"2023-05-23T12:19:28+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1684836669795_-609385233","id":"20230523-121109_408491429","dateCreated":"2023-05-23T12:11:09+0200","dateStarted":"2023-05-23T12:15:29+0200","dateFinished":"2023-05-23T12:15:30+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4171"},{"text":"%spark\nval cnmcSipscoFinalDF = (cnmcSipscoDF.select($\"cups\", \n                                             date_format($\"finicio\", \"yyyyMMdd\") as \"finicio\", \n                                             date_format($\"ffin\", \"yyyyMMdd\") as \"ffin\", \n                                             $\"tarifa\", $\"consumoactivap1\", $\"consumoactivap2\", $\"consumoactivap3\", $\"consumoactivap4\",      \n                                             $\"consumoactivap5\",$\"consumoactivap6\", $\"consumoreactivap1\", $\"consumoreactivap2\", $\"consumoreactivap3\", \n                                             $\"consumoreactivap4\", $\"consumoreactivap5\", $\"consumoreactivap6\", $\"potmaxp1\", $\"potmaxp2\", $\"potmaxp3\", \n                                             $\"potmaxp4\", $\"potmaxp5\", $\"potmaxp6\", \n                                             numDaysUDF($\"finicio\", $\"ffin\") as \"numdias\", \n                                             cmdUDF($\"consumoactivap1\", $\"consumoactivap2\", $\"consumoactivap3\", $\"consumoactivap4\",$\"consumoactivap5\", $\"consumoactivap6\", numDaysUDF($\"finicio\", $\"ffin\")) as \"cmd\"))\ncnmcSipscoFinalDF.show()\n","user":"anonymous","dateUpdated":"2023-05-23T12:15:35+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cnmcSipscoFinalDF: org.apache.spark.sql.DataFrame = [cups: string, finicio: string ... 22 more fields]\n+--------------------+--------+--------+------+---------------+---------------+---------------+---------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+--------+--------+--------+--------+--------+--------+-------+---------+\n|                cups| finicio|    ffin|tarifa|consumoactivap1|consumoactivap2|consumoactivap3|consumoactivap4|consumoactivap5|consumoactivap6|consumoreactivap1|consumoreactivap2|consumoreactivap3|consumoreactivap4|consumoreactivap5|consumoreactivap6|potmaxp1|potmaxp2|potmaxp3|potmaxp4|potmaxp5|potmaxp6|numdias|      cmd|\n+--------------------+--------+--------+------+---------------+---------------+---------------+---------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+--------+--------+--------+--------+--------+--------+-------+---------+\n|ES003362000001817...|20160114|20160214|   005|        29000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     31| 935.4839|\n|ES003362000001817...|20160214|20160314|   005|       108000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     29| 3724.138|\n|ES003362000001817...|20160314|20160414|   005|        29000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     30| 966.6667|\n|ES003362000001817...|20160414|20160514|   005|        11000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     30|366.66666|\n|ES003362000001817...|20160514|20160614|   005|        54000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     31|1741.9354|\n|ES003362000001817...|20160614|20160714|   005|        24000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     30|    800.0|\n|ES003362000001817...|20160714|20160814|   005|        15000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     31|483.87097|\n|ES003362000001817...|20160814|20160914|   005|        46000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     31| 1483.871|\n|ES003362000001817...|20160914|20161014|   005|        55000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     30|1833.3334|\n|ES003362000001817...|20161014|20161114|   005|        47000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     31| 1516.129|\n|ES003362000001817...|20161114|20161214|   005|         7000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     30|233.33333|\n|ES003362000001817...|20161214|20170114|   005|            0.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     31|      0.0|\n|ES003362000001817...|20170114|20170214|   005|       283000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     31| 9129.032|\n|ES003362000001817...|20170214|20170314|   005|       540000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     28|19285.715|\n|ES003362000001817...|20170314|20170414|   005|       284000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     30| 9466.667|\n|ES003362000001817...|20170414|20170514|   005|       165000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     30|   5500.0|\n|ES003362000001817...|20170514|20170614|   005|       126000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     31| 4064.516|\n|ES003362000001817...|20170614|20170714|   005|        98000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     30|3266.6667|\n|ES003362000001817...|20170714|20170814|   005|        85000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     31|2741.9355|\n|ES003362000001817...|20170814|20170914|   005|       117000.0|            0.0|            0.0|            0.0|            0.0|            0.0|              0.0|              0.0|              0.0|              0.0|              0.0|              0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     0.0|     31|3774.1936|\n+--------------------+--------+--------+------+---------------+---------------+---------------+---------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+--------+--------+--------+--------+--------+--------+-------+---------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1684351315543_-305897312","id":"20230517-212155_1082508170","dateCreated":"2023-05-17T21:21:55+0200","dateStarted":"2023-05-23T12:15:35+0200","dateFinished":"2023-05-23T12:15:37+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4172"},{"text":"%spark\n//check the schema and the type of data\ncnmcSipscoFinalDF.printSchema","user":"anonymous","dateUpdated":"2023-05-23T12:48:08+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- cups: string (nullable = true)\n |-- finicio: string (nullable = true)\n |-- ffin: string (nullable = true)\n |-- tarifa: string (nullable = true)\n |-- consumoactivap1: float (nullable = true)\n |-- consumoactivap2: float (nullable = true)\n |-- consumoactivap3: float (nullable = true)\n |-- consumoactivap4: float (nullable = true)\n |-- consumoactivap5: float (nullable = true)\n |-- consumoactivap6: float (nullable = true)\n |-- consumoreactivap1: float (nullable = true)\n |-- consumoreactivap2: float (nullable = true)\n |-- consumoreactivap3: float (nullable = true)\n |-- consumoreactivap4: float (nullable = true)\n |-- consumoreactivap5: float (nullable = true)\n |-- consumoreactivap6: float (nullable = true)\n |-- potmaxp1: float (nullable = true)\n |-- potmaxp2: float (nullable = true)\n |-- potmaxp3: float (nullable = true)\n |-- potmaxp4: float (nullable = true)\n |-- potmaxp5: float (nullable = true)\n |-- potmaxp6: float (nullable = true)\n |-- numdias: integer (nullable = false)\n |-- cmd: float (nullable = true)"}]},"apps":[],"jobName":"paragraph_1684838869477_1752790602","id":"20230523-124749_1755362813","dateCreated":"2023-05-23T12:47:49+0200","dateStarted":"2023-05-23T12:48:08+0200","dateFinished":"2023-05-23T12:48:09+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4173"},{"text":"%md\n####Sips \n","user":"anonymous","dateUpdated":"2023-05-23T12:11:07+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Sips</h4>\n"}]},"apps":[],"jobName":"paragraph_1684693917847_-118044942","id":"20230521-203157_597737147","dateCreated":"2023-05-21T20:31:57+0200","dateStarted":"2023-05-23T12:11:07+0200","dateFinished":"2023-05-23T12:11:07+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4174"},{"text":"%spark\n//cnmcSipsNewColumnsDF does:\n//Change the date format to \"yyyyMMdd\" with date_format\n//Creates the 'solicitudcorte' column and normalizes it to a boolean by assigning false to all elements in the column\n//Normalizes the 'autoconsumo' column, assigns false to all elements that are 0 and true in other cases","user":"anonymous","dateUpdated":"2023-05-23T12:24:05+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1684837032301_-367054277","id":"20230523-121712_268776368","dateCreated":"2023-05-23T12:17:12+0200","dateStarted":"2023-05-23T12:24:05+0200","dateFinished":"2023-05-23T12:24:06+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4175"},{"text":"%spark\nval cnmcSipsNewColumnsDF = (cnmcSipsDF.select($\"cups\", $\"distribuidora\", $\"coddist\", \n                                             date_format($\"falta\", \"yyyyMMdd\") as \"falta\", \n                                             $\"tarifa\", $\"tensionps\", $\"fases\", $\"potmaxbie\", $\"derext\", $\"deraccll\", $\"perfilree\", \n                                             $\"potcontrp1\", $\"potcontrp2\", $\"potcontrp3\", $\"potcontrp4\", $\"potcontrp5\", $\"potcontrp6\", $\"autoconsumo\")\n                                             .withColumn(\"solicitudcorte\", lit(false))\n                                             .withColumn(\"autoconsumo\", when(col(\"autoconsumo\") === 0, false).otherwise(true))\n                        )\ncnmcSipsNewColumnsDF.show(20)","user":"anonymous","dateUpdated":"2023-05-23T12:24:09+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cnmcSipsNewColumnsDF: org.apache.spark.sql.DataFrame = [cups: string, distribuidora: string ... 17 more fields]\n+--------------------+--------------------+-------+--------+------+---------+-----+---------+------+--------+---------+----------+----------+----------+----------+----------+----------+-----------+--------------+\n|                cups|       distribuidora|coddist|   falta|tarifa|tensionps|fases|potmaxbie|derext|deraccll|perfilree|potcontrp1|potcontrp2|potcontrp3|potcontrp4|potcontrp5|potcontrp6|autoconsumo|solicitudcorte|\n+--------------------+--------------------+-------+--------+------+---------+-----+---------+------+--------+---------+----------+----------+----------+----------+----------+----------+-----------+--------------+\n|ES0021000009557116XS|IBERDROLA DISTRIB...|   0021|19780203|   001|        9|    M|     3300|3300.0|  3300.0|       PA|    3300.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557115XZ|IBERDROLA DISTRIB...|   0021|19760719|   001|        9|    M|     3300|3300.0|  3300.0|       PA|    3300.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557126BW|IBERDROLA DISTRIB...|   0021|19790308|   001|       10|    M|     5750|4600.0|  4600.0|       PA|    4600.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557128BG|IBERDROLA DISTRIB...|   0021|19790308|   001|        9|    M|     3300|3300.0|  3300.0|       PA|    3300.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557085DF|IBERDROLA DISTRIB...|   0021|19790417|   001|        9|    M|     3300|3300.0|  3300.0|       PA|    3300.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557078DT|IBERDROLA DISTRIB...|   0021|19790704|   001|        2|    M|     5750|5750.0|  5750.0|       PA|    5750.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557131BF|IBERDROLA DISTRIB...|   0021|19790427|   001|        9|    M|     3300|3300.0|  3300.0|       PA|    3300.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557197ZG|IBERDROLA DISTRIB...|   0021|19790507|   001|        2|    M|     5750|3450.0|  3450.0|       PA|    3450.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557198ZM|IBERDROLA DISTRIB...|   0021|19790507|   001|        2|    M|     9200|6900.0|  6900.0|       PA|    6900.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557199ZY|IBERDROLA DISTRIB...|   0021|19790426|   001|        9|    M|     3300|3300.0|  3300.0|       PA|    3300.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557072PV|IBERDROLA DISTRIB...|   0021|19760112|   001|        7|    M|     1200|1200.0|  1200.0|       PA|    1200.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557032FT|IBERDROLA DISTRIB...|   0021|19880727|   001|        9|    M|     3300|3300.0|  3300.0|       PA|    3300.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557208ZS|IBERDROLA DISTRIB...|   0021|19771108|   001|        9|    M|     3300|3300.0|  3300.0|       PA|    3300.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557210ZV|IBERDROLA DISTRIB...|   0021|19790511|   001|        9|    M|     6000|4400.0|  4400.0|       PA|    4400.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557200ZF|IBERDROLA DISTRIB...|   0021|19931020|   001|        9|    M|     4400|4400.0|  4400.0|       PA|    4400.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557196ZA|IBERDROLA DISTRIB...|   0021|19851216|   001|        9|    M|     3300|3300.0|  3300.0|       PA|    3300.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557194ZR|IBERDROLA DISTRIB...|   0021|19790420|   004|        2|    M|     5750|5750.0|  3450.0|       PB|    3450.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557138BZ|IBERDROLA DISTRIB...|   0021|19900418|   001|       10|    M|     3450|3450.0|  3450.0|       PA|    3450.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557188JH|IBERDROLA DISTRIB...|   0021|19770728|   001|       10|    M|     9200|4600.0|  4600.0|       PA|    4600.0|      null|      null|      null|      null|      null|      false|         false|\n|ES0021000009557147NT|IBERDROLA DISTRIB...|   0021|19790417|   001|       10|    M|     8800|8800.0|  4600.0|       PA|    4600.0|      null|      null|      null|      null|      null|      false|         false|\n+--------------------+--------------------+-------+--------+------+---------+-----+---------+------+--------+---------+----------+----------+----------+----------+----------+----------+-----------+--------------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1684443952158_148377156","id":"20230518-230552_1255597780","dateCreated":"2023-05-18T23:05:52+0200","dateStarted":"2023-05-23T12:24:09+0200","dateFinished":"2023-05-23T12:24:11+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4176"},{"text":"%spark\n//Group the potmaxp1-6 columns of the Sispco data frame with respect to cups. Gets the maximum of each column and saves it in a data frame","user":"anonymous","dateUpdated":"2023-05-23T12:32:09+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1684837474968_548807497","id":"20230523-122434_91572136","dateCreated":"2023-05-23T12:24:34+0200","dateStarted":"2023-05-23T12:28:05+0200","dateFinished":"2023-05-23T12:28:06+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4177"},{"text":"%spark\nval cupsPotmaxp = cnmcSipscoFinalDF.groupBy(\"cups\").agg(max(\"potmaxp1\") as \"potmaxp1\", max(\"potmaxp2\") as \"potmaxp2\", max(\"potmaxp3\") as \"potmaxp3\", max(\"potmaxp4\") as \"potmaxp4\", max(\"potmaxp5\") as \"potmaxp5\", max(\"potmaxp6\") as \"potmaxp6\")\ncupsPotmaxp.show(false)\n\n","user":"anonymous","dateUpdated":"2023-05-23T12:28:09+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cupsPotmaxp: org.apache.spark.sql.DataFrame = [cups: string, potmaxp1: float ... 5 more fields]\n+----------------------+--------+--------+--------+--------+--------+--------+\n|cups                  |potmaxp1|potmaxp2|potmaxp3|potmaxp4|potmaxp5|potmaxp6|\n+----------------------+--------+--------+--------+--------+--------+--------+\n|ES0103060444868701ZL0F|0.0     |0.0     |0.0     |0.0     |0.0     |0.0     |\n|ES0022000004001073HA1P|null    |null    |null    |null    |null    |null    |\n|ES0022000004001080HX1P|null    |null    |null    |null    |null    |null    |\n|ES0022000004001792AD1P|null    |null    |null    |null    |null    |null    |\n|ES0022000004002288RE1P|null    |null    |null    |null    |null    |null    |\n|ES0022000004002752EA1P|null    |null    |null    |null    |null    |null    |\n|ES0022000004002793TK1P|null    |null    |null    |null    |null    |null    |\n|ES0022000004003424MP1P|15000.0 |15000.0 |15000.0 |15000.0 |15000.0 |15000.0 |\n|ES0022000004003696VG1P|null    |null    |null    |null    |null    |null    |\n|ES0022000004003950MM1P|null    |null    |null    |null    |null    |null    |\n|ES0022000004005020MV1P|null    |null    |null    |null    |null    |null    |\n|ES0022000004005439TE1P|null    |null    |null    |null    |null    |null    |\n|ES0022000004005878CR1P|null    |null    |null    |null    |null    |null    |\n|ES0022000004039742CD1P|null    |null    |null    |null    |null    |null    |\n|ES0022000004039787EP1P|null    |null    |null    |null    |null    |null    |\n|ES0022000004039957YV1P|null    |null    |null    |null    |null    |null    |\n|ES0022000004040861TR1P|null    |null    |null    |null    |null    |null    |\n|ES0022000004041193ZB1P|null    |null    |null    |null    |null    |null    |\n|ES0022000004041569FL1P|null    |null    |null    |null    |null    |null    |\n|ES0022000004041905EX1P|null    |null    |null    |null    |null    |null    |\n+----------------------+--------+--------+--------+--------+--------+--------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1684443638297_-1622949154","id":"20230518-230038_731924318","dateCreated":"2023-05-18T23:00:38+0200","dateStarted":"2023-05-23T12:28:09+0200","dateFinished":"2023-05-23T12:28:13+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4178"},{"text":"%spark\n//cnmcSipsPotmaxpDF performs a left join between cnmcSipsNewColumnsDF and cupsPotmaxp with cups as the key. The aim is to get the potmaxp1-6 for each cups of Sips","user":"anonymous","dateUpdated":"2023-05-23T12:59:43+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1684837706125_-1398058083","id":"20230523-122826_1847523081","dateCreated":"2023-05-23T12:28:26+0200","dateStarted":"2023-05-23T12:59:43+0200","dateFinished":"2023-05-23T12:59:44+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4179"},{"text":"%spark\nval cnmcSipsPotmaxpDF = (cnmcSipsNewColumnsDF.join(cupsPotmaxp, cnmcSipsNewColumnsDF(\"cups\") === cupsPotmaxp(\"cups\"), \"left\")\n                        .select(cnmcSipsNewColumnsDF.col(\"*\"), \n                        cupsPotmaxp.col(\"potmaxp1\").cast(DoubleType), cupsPotmaxp.col(\"potmaxp2\").cast(DoubleType), cupsPotmaxp.col(\"potmaxp3\").cast(DoubleType), \n                        cupsPotmaxp.col(\"potmaxp4\").cast(DoubleType), cupsPotmaxp.col(\"potmaxp5\").cast(DoubleType), cupsPotmaxp.col(\"potmaxp6\").cast(DoubleType))\n                        )\ncnmcSipsPotmaxpDF.show()","user":"anonymous","dateUpdated":"2023-05-23T12:33:40+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cnmcSipsPotmaxpDF: org.apache.spark.sql.DataFrame = [cups: string, distribuidora: string ... 23 more fields]\n+--------------------+--------------------+-------+--------+------+---------+-----+---------+------+--------+---------+----------+----------+----------+----------+----------+----------+-----------+--------------+--------+--------+--------+--------+--------+--------+\n|                cups|       distribuidora|coddist|   falta|tarifa|tensionps|fases|potmaxbie|derext|deraccll|perfilree|potcontrp1|potcontrp2|potcontrp3|potcontrp4|potcontrp5|potcontrp6|autoconsumo|solicitudcorte|potmaxp1|potmaxp2|potmaxp3|potmaxp4|potmaxp5|potmaxp6|\n+--------------------+--------------------+-------+--------+------+---------+-----+---------+------+--------+---------+----------+----------+----------+----------+----------+----------+-----------+--------------+--------+--------+--------+--------+--------+--------+\n|ES0021000009557116XS|IBERDROLA DISTRIB...|   0021|19780203|   001|        9|    M|     3300|3300.0|  3300.0|       PA|    3300.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557115XZ|IBERDROLA DISTRIB...|   0021|19760719|   001|        9|    M|     3300|3300.0|  3300.0|       PA|    3300.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557126BW|IBERDROLA DISTRIB...|   0021|19790308|   001|       10|    M|     5750|4600.0|  4600.0|       PA|    4600.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557128BG|IBERDROLA DISTRIB...|   0021|19790308|   001|        9|    M|     3300|3300.0|  3300.0|       PA|    3300.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557085DF|IBERDROLA DISTRIB...|   0021|19790417|   001|        9|    M|     3300|3300.0|  3300.0|       PA|    3300.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557078DT|IBERDROLA DISTRIB...|   0021|19790704|   001|        2|    M|     5750|5750.0|  5750.0|       PA|    5750.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557131BF|IBERDROLA DISTRIB...|   0021|19790427|   001|        9|    M|     3300|3300.0|  3300.0|       PA|    3300.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557197ZG|IBERDROLA DISTRIB...|   0021|19790507|   001|        2|    M|     5750|3450.0|  3450.0|       PA|    3450.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557198ZM|IBERDROLA DISTRIB...|   0021|19790507|   001|        2|    M|     9200|6900.0|  6900.0|       PA|    6900.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557199ZY|IBERDROLA DISTRIB...|   0021|19790426|   001|        9|    M|     3300|3300.0|  3300.0|       PA|    3300.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557072PV|IBERDROLA DISTRIB...|   0021|19760112|   001|        7|    M|     1200|1200.0|  1200.0|       PA|    1200.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557032FT|IBERDROLA DISTRIB...|   0021|19880727|   001|        9|    M|     3300|3300.0|  3300.0|       PA|    3300.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557208ZS|IBERDROLA DISTRIB...|   0021|19771108|   001|        9|    M|     3300|3300.0|  3300.0|       PA|    3300.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557210ZV|IBERDROLA DISTRIB...|   0021|19790511|   001|        9|    M|     6000|4400.0|  4400.0|       PA|    4400.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557200ZF|IBERDROLA DISTRIB...|   0021|19931020|   001|        9|    M|     4400|4400.0|  4400.0|       PA|    4400.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557196ZA|IBERDROLA DISTRIB...|   0021|19851216|   001|        9|    M|     3300|3300.0|  3300.0|       PA|    3300.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557194ZR|IBERDROLA DISTRIB...|   0021|19790420|   004|        2|    M|     5750|5750.0|  3450.0|       PB|    3450.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557138BZ|IBERDROLA DISTRIB...|   0021|19900418|   001|       10|    M|     3450|3450.0|  3450.0|       PA|    3450.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557188JH|IBERDROLA DISTRIB...|   0021|19770728|   001|       10|    M|     9200|4600.0|  4600.0|       PA|    4600.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n|ES0021000009557147NT|IBERDROLA DISTRIB...|   0021|19790417|   001|       10|    M|     8800|8800.0|  4600.0|       PA|    4600.0|      null|      null|      null|      null|      null|      false|         false|    null|    null|    null|    null|    null|    null|\n+--------------------+--------------------+-------+--------+------+---------+-----+---------+------+--------+---------+----------+----------+----------+----------+----------+----------+-----------+--------------+--------+--------+--------+--------+--------+--------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1684443646447_556881922","id":"20230518-230046_687076869","dateCreated":"2023-05-18T23:00:46+0200","dateStarted":"2023-05-23T12:33:40+0200","dateFinished":"2023-05-23T12:33:45+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4180"},{"text":"%spark\n//cnmcSipsFinalDF sorts the data frame columns according to the project convention","user":"anonymous","dateUpdated":"2023-05-23T12:36:22+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1684838032237_-1446484396","id":"20230523-123352_617697871","dateCreated":"2023-05-23T12:33:52+0200","dateStarted":"2023-05-23T12:36:22+0200","dateFinished":"2023-05-23T12:36:23+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4181"},{"text":"%spark\nval cnmcSipsFinalDF = (cnmcSipsPotmaxpDF.select(\"cups\", \"distribuidora\", \"coddist\", \"falta\", \"tarifa\", \"tensionps\", \"fases\", \"potmaxbie\", \"derext\",\n                                               \"deraccll\", \"perfilree\", \"potcontrp1\", \"potcontrp2\", \"potcontrp3\", \"potcontrp4\", \"potcontrp5\", \"potcontrp6\",\n                                               \"potmaxp1\", \"potmaxp2\", \"potmaxp3\", \"potmaxp4\", \"potmaxp5\", \"potmaxp6\", \"solicitudcorte\", \"autoconsumo\")\n                                               )\ncnmcSipsFinalDF.show(false)","user":"anonymous","dateUpdated":"2023-05-23T12:35:47+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cnmcSipsFinalDF: org.apache.spark.sql.DataFrame = [cups: string, distribuidora: string ... 23 more fields]\n+--------------------+--------------------------------------+-------+--------+------+---------+-----+---------+------+--------+---------+----------+----------+----------+----------+----------+----------+--------+--------+--------+--------+--------+--------+--------------+-----------+\n|cups                |distribuidora                         |coddist|falta   |tarifa|tensionps|fases|potmaxbie|derext|deraccll|perfilree|potcontrp1|potcontrp2|potcontrp3|potcontrp4|potcontrp5|potcontrp6|potmaxp1|potmaxp2|potmaxp3|potmaxp4|potmaxp5|potmaxp6|solicitudcorte|autoconsumo|\n+--------------------+--------------------------------------+-------+--------+------+---------+-----+---------+------+--------+---------+----------+----------+----------+----------+----------+----------+--------+--------+--------+--------+--------+--------+--------------+-----------+\n|ES0021000009557116XS|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19780203|001   |9        |M    |3300     |3300.0|3300.0  |PA       |3300.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557115XZ|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19760719|001   |9        |M    |3300     |3300.0|3300.0  |PA       |3300.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557126BW|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19790308|001   |10       |M    |5750     |4600.0|4600.0  |PA       |4600.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557128BG|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19790308|001   |9        |M    |3300     |3300.0|3300.0  |PA       |3300.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557085DF|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19790417|001   |9        |M    |3300     |3300.0|3300.0  |PA       |3300.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557078DT|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19790704|001   |2        |M    |5750     |5750.0|5750.0  |PA       |5750.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557131BF|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19790427|001   |9        |M    |3300     |3300.0|3300.0  |PA       |3300.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557197ZG|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19790507|001   |2        |M    |5750     |3450.0|3450.0  |PA       |3450.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557198ZM|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19790507|001   |2        |M    |9200     |6900.0|6900.0  |PA       |6900.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557199ZY|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19790426|001   |9        |M    |3300     |3300.0|3300.0  |PA       |3300.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557072PV|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19760112|001   |7        |M    |1200     |1200.0|1200.0  |PA       |1200.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557032FT|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19880727|001   |9        |M    |3300     |3300.0|3300.0  |PA       |3300.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557208ZS|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19771108|001   |9        |M    |3300     |3300.0|3300.0  |PA       |3300.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557210ZV|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19790511|001   |9        |M    |6000     |4400.0|4400.0  |PA       |4400.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557200ZF|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19931020|001   |9        |M    |4400     |4400.0|4400.0  |PA       |4400.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557196ZA|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19851216|001   |9        |M    |3300     |3300.0|3300.0  |PA       |3300.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557194ZR|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19790420|004   |2        |M    |5750     |5750.0|3450.0  |PB       |3450.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557138BZ|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19900418|001   |10       |M    |3450     |3450.0|3450.0  |PA       |3450.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557188JH|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19770728|001   |10       |M    |9200     |4600.0|4600.0  |PA       |4600.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n|ES0021000009557147NT|IBERDROLA DISTRIBUCION ELECTRICA, S.A.|0021   |19790417|001   |10       |M    |8800     |8800.0|4600.0  |PA       |4600.0    |null      |null      |null      |null      |null      |null    |null    |null    |null    |null    |null    |false         |false      |\n+--------------------+--------------------------------------+-------+--------+------+---------+-----+---------+------+--------+---------+----------+----------+----------+----------+----------+----------+--------+--------+--------+--------+--------+--------+--------------+-----------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1684783975269_166612883","id":"20230522-213255_1334478608","dateCreated":"2023-05-22T21:32:55+0200","dateStarted":"2023-05-23T12:35:47+0200","dateFinished":"2023-05-23T12:35:51+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4182"},{"text":"%spark\n//check the schema and the type of data\ncnmcSipsFinalDF.printSchema","user":"anonymous","dateUpdated":"2023-05-23T12:37:13+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- cups: string (nullable = true)\n |-- distribuidora: string (nullable = true)\n |-- coddist: string (nullable = true)\n |-- falta: string (nullable = true)\n |-- tarifa: string (nullable = true)\n |-- tensionps: integer (nullable = true)\n |-- fases: string (nullable = true)\n |-- potmaxbie: string (nullable = true)\n |-- derext: double (nullable = true)\n |-- deraccll: double (nullable = true)\n |-- perfilree: string (nullable = true)\n |-- potcontrp1: double (nullable = true)\n |-- potcontrp2: double (nullable = true)\n |-- potcontrp3: double (nullable = true)\n |-- potcontrp4: double (nullable = true)\n |-- potcontrp5: double (nullable = true)\n |-- potcontrp6: double (nullable = true)\n |-- potmaxp1: double (nullable = true)\n |-- potmaxp2: double (nullable = true)\n |-- potmaxp3: double (nullable = true)\n |-- potmaxp4: double (nullable = true)\n |-- potmaxp5: double (nullable = true)\n |-- potmaxp6: double (nullable = true)\n |-- solicitudcorte: boolean (nullable = false)\n |-- autoconsumo: boolean (nullable = false)"}]},"apps":[],"jobName":"paragraph_1684783609608_-1188616121","id":"20230522-212649_634423783","dateCreated":"2023-05-22T21:26:49+0200","dateStarted":"2023-05-23T12:37:14+0200","dateFinished":"2023-05-23T12:37:15+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4183"},{"text":"%md\n##Viesgo and Begasa\n","user":"anonymous","dateUpdated":"2023-05-22T21:09:55+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Viesgo and Begasa</h2>\n"}]},"apps":[],"jobName":"paragraph_1684694520730_-404190994","id":"20230521-204200_1212920413","dateCreated":"2023-05-21T20:42:00+0200","dateStarted":"2023-05-22T21:09:55+0200","dateFinished":"2023-05-22T21:09:55+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4184"},{"text":"%md\n####Sips for Viesgo and Begasa\n","user":"anonymous","dateUpdated":"2023-05-22T21:10:05+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Sips for Viesgo and Begasa</h4>\n"}]},"apps":[],"jobName":"paragraph_1684694034407_-2129327482","id":"20230521-203354_2000291263","dateCreated":"2023-05-21T20:33:54+0200","dateStarted":"2023-05-22T21:10:05+0200","dateFinished":"2023-05-22T21:10:05+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4185"},{"text":"%spark\n//viesgoBegasaSipsNewColumnsDF does:\n//Creates the 'solicitudcorte' column and normalizes it to a boolean by assigning false to all elements in the column\n//Normalizes the 'autoconsumo' column, assigns false to all elements that are 0 and true in other cases\n//Creates the 'potmaxp1-6' columns with zeros to have the number columns according to the convention of the project tables and and be able to create the general sips table in the golden layer","user":"anonymous","dateUpdated":"2023-05-23T12:45:24+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1684838266555_448100238","id":"20230523-123746_537659239","dateCreated":"2023-05-23T12:37:46+0200","dateStarted":"2023-05-23T12:44:38+0200","dateFinished":"2023-05-23T12:44:39+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4186"},{"text":"%spark\nval viesgoBegasaSipsNewColumnsDF = (viesgoBegasaSipsDF.withColumn(\"solicitudcorte\", lit(false))\n                                                      .withColumn(\"autoconsumo\", when(col(\"autoconsumo\") === 0, false).otherwise(true))\n                                                      .withColumn(\"potmaxp2\", lit(0.0))\n                                                      .withColumn(\"potmaxp3\", lit(0.0))\n                                                      .withColumn(\"potmaxp4\", lit(0.0))\n                                                      .withColumn(\"potmaxp5\", lit(0.0))\n                                                      .withColumn(\"potmaxp6\", lit(0.0))\n                                 )\n","user":"anonymous","dateUpdated":"2023-05-23T12:41:50+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"viesgoBegasaSipsNewColumnsDF: org.apache.spark.sql.DataFrame = [cups: string, distribuidora: string ... 43 more fields]"}]},"apps":[],"jobName":"paragraph_1684617655238_-1200552733","id":"20230520-232055_1731018378","dateCreated":"2023-05-20T23:20:55+0200","dateStarted":"2023-05-23T12:41:51+0200","dateFinished":"2023-05-23T12:41:52+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4187"},{"text":"%spark\n////viesgoBegasaSipsFinalDF sorts the data frame columns according to the project convention","user":"anonymous","dateUpdated":"2023-05-23T12:46:28+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1684838527569_1905315146","id":"20230523-124207_717127751","dateCreated":"2023-05-23T12:42:07+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:4188"},{"text":"%spark\nval viesgoBegasaSipsFinalDF = (viesgoBegasaSipsNewColumnsDF.select(\"cups\", \"distribuidora\", \"coddist\", \"falta\", \"tarifa\", \"tensionps\", \"fases\", \"potmaxbie\", \"derext\", \n                                                                    \"deraccll\", \"perfilree\", \"potcontrp1\", \"potcontrp2\", \"potcontrp3\", \"potcontrp4\", \"potcontrp5\", \"potcontrp6\", \n                                                                    \"potmaxp1\", \"potmaxp2\", \"potmaxp3\", \"potmaxp4\", \"potmaxp5\", \"potmaxp6\", \"solicitudcorte\", \"autoconsumo\")\n                                                                    )\nviesgoBegasaSipsFinalDF.show(false)","user":"anonymous","dateUpdated":"2023-05-23T12:46:33+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"viesgoBegasaSipsFinalDF: org.apache.spark.sql.DataFrame = [cups: string, distribuidora: string ... 23 more fields]\n+----------------------+-----------------------------------+-------+--------+------+---------+-----+---------+------+--------+---------+----------+----------+----------+----------+----------+----------+--------+--------+--------+--------+--------+--------+--------------+-----------+\n|cups                  |distribuidora                      |coddist|falta   |tarifa|tensionps|fases|potmaxbie|derext|deraccll|perfilree|potcontrp1|potcontrp2|potcontrp3|potcontrp4|potcontrp5|potcontrp6|potmaxp1|potmaxp2|potmaxp3|potmaxp4|potmaxp5|potmaxp6|solicitudcorte|autoconsumo|\n+----------------------+-----------------------------------+-------+--------+------+---------+-----+---------+------+--------+---------+----------+----------+----------+----------+----------+----------+--------+--------+--------+--------+--------+--------+--------------+-----------+\n|ES0027460000000003KD0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |20111102|2.0A  |null     |M    |9.2      |6.9   |null    |Pa       |6.9       |0.0       |0.0       |0.0       |0.0       |0.0       |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000006KN0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |20111110|null  |null     |null |9.2      |9.2   |9.2     |null     |null      |null      |null      |null      |null      |null      |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000007KJ0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |20111102|2.0A  |null     |M    |5.75     |0.0   |null    |Pa       |5.75      |0.0       |0.0       |0.0       |0.0       |0.0       |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000008KZ0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |20111103|2.0A  |null     |M    |5.75     |5.75  |4.6     |Pa       |4.6       |0.0       |0.0       |0.0       |0.0       |0.0       |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000011KV0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |null    |null  |null     |null |null     |0.0   |null    |null     |null      |null      |null      |null      |null      |null      |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000012KH0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |20111123|6.1B  |null     |T    |1730     |4114.0|2572.0  |null     |940.0     |940.0     |940.0     |940.0     |940.0     |2572.0    |0.0     |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000013KL0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |20111103|2.0A  |null     |M    |5.75     |0.0   |null    |Pa       |4.6       |0.0       |0.0       |0.0       |0.0       |0.0       |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000014KC0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |20111103|2.0A  |null     |M    |3.68     |0.0   |null    |Pa       |3.45      |0.0       |0.0       |0.0       |0.0       |0.0       |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000021EG0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |20111104|2.0A  |null     |M    |9.2      |5.75  |null    |Pa       |5.75      |0.0       |0.0       |0.0       |0.0       |0.0       |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000022EM0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |20111104|3.0A  |null     |T    |43.648   |43.648|43.648  |Pc       |36.769    |36.769    |43.648    |0.0       |0.0       |0.0       |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000023EY0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |20111104|null  |null     |null |5.75     |5.75  |3.45    |null     |null      |null      |null      |null      |null      |null      |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000024EF0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |20111104|3.0A  |null     |T    |125      |125.0 |null    |Pc       |63.0      |63.0      |63.0      |0.0       |0.0       |0.0       |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000025EP0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |20111104|2.0A  |null     |M    |9.2      |5.75  |null    |Pa       |5.75      |0.0       |0.0       |0.0       |0.0       |0.0       |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000026ED0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |20111104|null  |null     |null |5.75     |0.0   |null    |null     |null      |null      |null      |null      |null      |null      |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000027EX0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |20111223|null  |null     |null |11.5     |5.75  |null    |null     |null      |null      |null      |null      |null      |null      |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000031EZ0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |20111104|2.0DHA|230      |M    |9.2      |4.6   |4.6     |Pb       |4.6       |0.0       |0.0       |0.0       |0.0       |0.0       |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000034EV0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |20111104|2.0A  |null     |M    |6.9      |5.75  |6.9     |Pa       |6.9       |0.0       |0.0       |0.0       |0.0       |0.0       |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000035EH0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |20111107|2.0DHA|null     |M    |5.75     |0.0   |null    |Pa       |5.75      |0.0       |0.0       |0.0       |0.0       |0.0       |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000036EL0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |null    |null  |null     |null |null     |5.75  |null    |null     |null      |null      |null      |null      |null      |null      |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n|ES0027460000000037EC0F|VIESGO DISTRIBUCION ELECTRICA, S.L.|0027   |null    |null  |null     |null |null     |9.2   |null    |null     |null      |null      |null      |null      |null      |null      |null    |0.0     |0.0     |0.0     |0.0     |0.0     |false         |false      |\n+----------------------+-----------------------------------+-------+--------+------+---------+-----+---------+------+--------+---------+----------+----------+----------+----------+----------+----------+--------+--------+--------+--------+--------+--------+--------------+-----------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1684617127848_856168038","id":"20230520-231207_1350373935","dateCreated":"2023-05-20T23:12:07+0200","dateStarted":"2023-05-23T12:46:33+0200","dateFinished":"2023-05-23T12:46:35+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4189"},{"text":"%spark\n//check the schema and the type of data\nviesgoBegasaSipsFinalDF.printSchema","user":"anonymous","dateUpdated":"2023-05-23T12:49:05+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- cups: string (nullable = true)\n |-- distribuidora: string (nullable = true)\n |-- coddist: string (nullable = true)\n |-- falta: string (nullable = true)\n |-- tarifa: string (nullable = true)\n |-- tensionps: integer (nullable = true)\n |-- fases: string (nullable = true)\n |-- potmaxbie: string (nullable = true)\n |-- derext: double (nullable = true)\n |-- deraccll: double (nullable = true)\n |-- perfilree: string (nullable = true)\n |-- potcontrp1: double (nullable = true)\n |-- potcontrp2: double (nullable = true)\n |-- potcontrp3: double (nullable = true)\n |-- potcontrp4: double (nullable = true)\n |-- potcontrp5: double (nullable = true)\n |-- potcontrp6: double (nullable = true)\n |-- potmaxp1: double (nullable = true)\n |-- potmaxp2: double (nullable = false)\n |-- potmaxp3: double (nullable = false)\n |-- potmaxp4: double (nullable = false)\n |-- potmaxp5: double (nullable = false)\n |-- potmaxp6: double (nullable = false)\n |-- solicitudcorte: boolean (nullable = false)\n |-- autoconsumo: boolean (nullable = false)"}]},"apps":[],"jobName":"paragraph_1684618509382_-1945855831","id":"20230520-233509_706512482","dateCreated":"2023-05-20T23:35:09+0200","dateStarted":"2023-05-23T12:49:05+0200","dateFinished":"2023-05-23T12:49:06+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4190"},{"text":"%md\n####Sipsco for Viesgo and Begasa\n","user":"anonymous","dateUpdated":"2023-05-22T21:10:21+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Sipsco for Viesgo and Begasa</h4>\n"}]},"apps":[],"jobName":"paragraph_1684694397255_146466335","id":"20230521-203957_1786659315","dateCreated":"2023-05-21T20:39:57+0200","dateStarted":"2023-05-22T21:10:21+0200","dateFinished":"2023-05-22T21:10:21+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4191"},{"text":"%spark\n//viesgoBegasaSipscoDFNewColumnsDF does:\n//Creates the 'potmaxp2-6', 'consumoactivap2-6' and 'consumoreactivap2-6' columns with float zeros to have the number columns according to the convention of the project tables and\n//and be able to create the general sips table in the golden layer\n//Apply the numDays and cmdUDF to respective columns \n","user":"anonymous","dateUpdated":"2023-05-23T12:56:08+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1684838997285_-1794765945","id":"20230523-124957_1578072337","dateCreated":"2023-05-23T12:49:57+0200","dateStarted":"2023-05-23T12:56:08+0200","dateFinished":"2023-05-23T12:56:09+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4192"},{"text":"%spark\nval viesgoBegasaSipscoDFNewColumnsDF = (viesgoBegasaSipscoDF.withColumn(\"consumoactivap2\", lit(0.0f))\n                                                            .withColumn(\"consumoactivap3\", lit(0.0f))\n                                                            .withColumn(\"consumoactivap4\", lit(0.0f))\n                                                            .withColumn(\"consumoactivap5\", lit(0.0f))\n                                                            .withColumn(\"consumoactivap6\", lit(0.0f))\n                                                            .withColumn(\"consumoreactivap2\", lit(0.0f))\n                                                            .withColumn(\"consumoreactivap3\", lit(0.0f))\n                                                            .withColumn(\"consumoreactivap5\", lit(0.0f))\n                                                            .withColumn(\"consumoreactivap6\", lit(0.0f))\n                                                            .withColumn(\"potmaxp2\", lit(0.0f))\n                                                            .withColumn(\"potmaxp3\", lit(0.0f))\n                                                            .withColumn(\"potmaxp4\", lit(0.0f))\n                                                            .withColumn(\"potmaxp5\", lit(0.0f))\n                                                            .withColumn(\"potmaxp6\", lit(0.0f))\n                                                            .withColumn(\"numdias\", numDaysUDF($\"finicio\", $\"ffin\"))\n                                                            .withColumn(\"cmd\", cmdUDF($\"consumoactivap1\", $\"consumoactivap2\", $\"consumoactivap3\", $\"consumoactivap4\",\n                                                             $\"consumoactivap5\", $\"consumoactivap6\", numDaysUDF($\"finicio\", $\"ffin\")))\n                                )\nviesgoBegasaSipscoDFNewColumnsDF.show(false)","user":"anonymous","dateUpdated":"2023-05-23T12:54:59+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"viesgoBegasaSipscoDFNewColumnsDF: org.apache.spark.sql.DataFrame = [cups: string, anio_facturacion: int ... 24 more fields]\n+----------------------+----------------+-------------------+-------------------+-------+---------------+-----------------+-----------------+-------------+------+---------------+---------------+---------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+--------+--------+--------+--------+--------+-------+-----------+\n|cups                  |anio_facturacion|finicio            |ffin               |periodo|consumoactivap1|consumoreactivap1|consumoreactivap4|pot_facturada|tarifa|consumoactivap2|consumoactivap3|consumoactivap4|consumoactivap5|consumoactivap6|consumoreactivap2|consumoreactivap3|consumoreactivap5|consumoreactivap6|potmaxp2|potmaxp3|potmaxp4|potmaxp5|potmaxp6|numdias|cmd        |\n+----------------------+----------------+-------------------+-------------------+-------+---------------+-----------------+-----------------+-------------+------+---------------+---------------+---------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+--------+--------+--------+--------+--------+-------+-----------+\n|ES0027460000008537RX0F|2016            |2016-03-11 00:00:00|2016-04-10 00:00:00|2      |614000.0       |775000.0         |null             |11000        |003   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |21172.414  |\n|ES0027460000008562WN0F|2017            |2017-03-05 00:00:00|2017-04-04 00:00:00|1      |37000.0        |null             |null             |null         |001   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |1275.862   |\n|ES0027460000008592AL0F|2016            |2016-07-07 00:00:00|2016-08-06 00:00:00|1      |273000.0       |null             |null             |null         |001   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |30     |9100.0     |\n|ES0027460000008598GW0F|2016            |2015-12-02 00:00:00|2016-01-01 00:00:00|2      |136000.0       |null             |null             |null         |004   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |30     |4533.3335  |\n|ES0027460000008599GA0F|2016            |2016-02-10 00:00:00|2016-03-09 00:00:00|1      |0.0            |null             |null             |null         |001   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |28     |0.0        |\n|ES0027460000008602GY0F|2016            |2015-12-02 00:00:00|2016-01-01 00:00:00|1      |236000.0       |null             |null             |null         |001   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |30     |7866.6665  |\n|ES0027460000008611GS0F|2017            |2017-04-11 00:00:00|2017-05-10 00:00:00|1      |393000.0       |null             |null             |null         |001   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |13551.725  |\n|ES0027460000008498EV0F|2016            |2016-09-01 00:00:00|2016-09-30 00:00:00|2      |1.2928E7       |3791000.0        |0.0              |75000        |003   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |445793.1   |\n|ES0027460000008532RM0F|2017            |2017-10-01 00:00:00|2017-10-31 00:00:00|6      |4.16328992E8   |2.9601E7         |6096000.0        |1766000      |017   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |30     |1.3877633E7|\n|ES0027460000008584AB0F|2016            |2016-07-01 00:00:00|2016-07-31 00:00:00|2      |1095000.0      |0.0              |303000.0         |9000         |003   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |30     |36500.0    |\n|ES0027460000008631MN0F|2017            |2017-03-07 00:00:00|2017-04-06 00:00:00|1      |29000.0        |null             |null             |null         |001   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |1000.0     |\n|ES0027460000008668FA0F|2017            |2017-05-11 00:00:00|2017-06-10 00:00:00|2      |146000.0       |null             |null             |null         |004   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |30     |4866.6665  |\n|ES0027460000008682FV0F|2015            |2015-06-07 00:00:00|2015-07-06 00:00:00|3      |3000.0         |0.0              |null             |0            |003   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |103.44827  |\n|ES0027460000008684FL0F|2017            |2017-03-11 00:00:00|2017-04-10 00:00:00|2      |555000.0       |null             |null             |null         |004   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |19137.932  |\n|ES0027460000008763BY0F|2015            |2015-11-11 00:00:00|2015-12-04 00:00:00|1      |0.0            |null             |null             |null         |001   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |23     |0.0        |\n|ES0027460000008764BF0F|2017            |2017-04-05 00:00:00|2017-05-04 00:00:00|1      |80000.0        |null             |null             |null         |004   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |2758.6206  |\n|ES0027460000008767BX0F|2015            |2015-11-04 00:00:00|2015-12-03 00:00:00|1      |261000.0       |null             |null             |0            |001   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |9000.0     |\n|ES0027460000008770BJ0F|2016            |2016-03-04 00:00:00|2016-04-03 00:00:00|1      |72000.0        |null             |null             |null         |001   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |2482.7585  |\n|ES0027460000008771BZ0F|2015            |2015-06-08 00:00:00|2015-07-04 00:00:00|1      |59000.0        |null             |null             |null         |001   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |26     |2269.2307  |\n|ES0027460000008771BZ0F|2017            |2017-03-07 00:00:00|2017-04-06 00:00:00|1      |107000.0       |null             |null             |null         |001   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |3689.6553  |\n+----------------------+----------------+-------------------+-------------------+-------+---------------+-----------------+-----------------+-------------+------+---------------+---------------+---------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+--------+--------+--------+--------+--------+-------+-----------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1684682680721_1415160675","id":"20230521-172440_942305195","dateCreated":"2023-05-21T17:24:40+0200","dateStarted":"2023-05-23T12:55:00+0200","dateFinished":"2023-05-23T12:55:03+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4193"},{"text":"%spark\n//Change the format of the dates to \"yyyyMMdd\"","user":"anonymous","dateUpdated":"2023-05-23T12:57:40+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1684839386031_427136956","id":"20230523-125626_154568939","dateCreated":"2023-05-23T12:56:26+0200","dateStarted":"2023-05-23T12:57:40+0200","dateFinished":"2023-05-23T12:57:41+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4194"},{"text":"%spark\nval viesgoBegasaSipscoFormatDateDF = (viesgoBegasaSipscoDFNewColumnsDF.select($\"cups\", date_format($\"finicio\", \"yyyyMMdd\") as \"finicio\", \n                                                                                       date_format($\"ffin\", \"yyyyMMdd\") as \"ffin\", \n                                                                                       $\"tarifa\", $\"consumoactivap1\", $\"consumoactivap2\", $\"consumoactivap3\", \n                                                                                       $\"consumoactivap4\", $\"consumoactivap5\", $\"consumoactivap6\", $\"consumoreactivap1\",\n                                                                                       $\"consumoreactivap2\", $\"consumoreactivap3\", $\"consumoreactivap4\", $\"consumoreactivap5\", \n                                                                                       $\"consumoreactivap6\", $\"potmaxp2\", $\"potmaxp3\", $\"potmaxp4\", $\"potmaxp5\", $\"potmaxp6\", $\"numdias\", $\"cmd\")\n                                        )\nviesgoBegasaSipscoFormatDateDF.show(false)\n","user":"anonymous","dateUpdated":"2023-05-23T12:57:17+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"viesgoBegasaSipscoFormatDateDF: org.apache.spark.sql.DataFrame = [cups: string, finicio: string ... 21 more fields]\n+----------------------+--------+--------+------+---------------+---------------+---------------+---------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+--------+--------+--------+--------+--------+-------+-----------+\n|cups                  |finicio |ffin    |tarifa|consumoactivap1|consumoactivap2|consumoactivap3|consumoactivap4|consumoactivap5|consumoactivap6|consumoreactivap1|consumoreactivap2|consumoreactivap3|consumoreactivap4|consumoreactivap5|consumoreactivap6|potmaxp2|potmaxp3|potmaxp4|potmaxp5|potmaxp6|numdias|cmd        |\n+----------------------+--------+--------+------+---------------+---------------+---------------+---------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+--------+--------+--------+--------+--------+-------+-----------+\n|ES0027460000008537RX0F|20160311|20160410|003   |614000.0       |0.0            |0.0            |0.0            |0.0            |0.0            |775000.0         |0.0              |0.0              |null             |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |21172.414  |\n|ES0027460000008562WN0F|20170305|20170404|001   |37000.0        |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |1275.862   |\n|ES0027460000008592AL0F|20160707|20160806|001   |273000.0       |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |30     |9100.0     |\n|ES0027460000008598GW0F|20151202|20160101|004   |136000.0       |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |30     |4533.3335  |\n|ES0027460000008599GA0F|20160210|20160309|001   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |28     |0.0        |\n|ES0027460000008602GY0F|20151202|20160101|001   |236000.0       |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |30     |7866.6665  |\n|ES0027460000008611GS0F|20170411|20170510|001   |393000.0       |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |13551.725  |\n|ES0027460000008498EV0F|20160901|20160930|003   |1.2928E7       |0.0            |0.0            |0.0            |0.0            |0.0            |3791000.0        |0.0              |0.0              |0.0              |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |445793.1   |\n|ES0027460000008532RM0F|20171001|20171031|017   |4.16328992E8   |0.0            |0.0            |0.0            |0.0            |0.0            |2.9601E7         |0.0              |0.0              |6096000.0        |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |30     |1.3877633E7|\n|ES0027460000008584AB0F|20160701|20160731|003   |1095000.0      |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |303000.0         |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |30     |36500.0    |\n|ES0027460000008631MN0F|20170307|20170406|001   |29000.0        |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |1000.0     |\n|ES0027460000008668FA0F|20170511|20170610|004   |146000.0       |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |30     |4866.6665  |\n|ES0027460000008682FV0F|20150607|20150706|003   |3000.0         |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |null             |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |103.44827  |\n|ES0027460000008684FL0F|20170311|20170410|004   |555000.0       |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |19137.932  |\n|ES0027460000008763BY0F|20151111|20151204|001   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |23     |0.0        |\n|ES0027460000008764BF0F|20170405|20170504|004   |80000.0        |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |2758.6206  |\n|ES0027460000008767BX0F|20151104|20151203|001   |261000.0       |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |9000.0     |\n|ES0027460000008770BJ0F|20160304|20160403|001   |72000.0        |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |2482.7585  |\n|ES0027460000008771BZ0F|20150608|20150704|001   |59000.0        |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |26     |2269.2307  |\n|ES0027460000008771BZ0F|20170307|20170406|001   |107000.0       |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |0.0     |0.0     |0.0     |0.0     |0.0     |29     |3689.6553  |\n+----------------------+--------+--------+------+---------------+---------------+---------------+---------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+--------+--------+--------+--------+--------+-------+-----------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1684683830189_-474256010","id":"20230521-174350_733400578","dateCreated":"2023-05-21T17:43:50+0200","dateStarted":"2023-05-23T12:57:17+0200","dateFinished":"2023-05-23T12:57:19+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4195"},{"text":"%spark\n//viesgoBegasaSipscoFinalDF performs a left join between viesgoBegasaSipscoFormatDateDF and viesgoBegasaSipsFinalDF with cups as the key. The aim is to get the potmaxp1 for each cups of Sipsco","user":"anonymous","dateUpdated":"2023-05-23T13:01:13+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1684839472341_-1612447986","id":"20230523-125752_1129763208","dateCreated":"2023-05-23T12:57:52+0200","dateStarted":"2023-05-23T13:01:13+0200","dateFinished":"2023-05-23T13:01:14+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4196"},{"text":"%spark\nval viesgoBegasaSipscoFinalDF = (viesgoBegasaSipscoFormatDateDF.join(viesgoBegasaSipsFinalDF, viesgoBegasaSipsFinalDF(\"cups\") === viesgoBegasaSipscoFormatDateDF(\"cups\"), \"left\")\n                                .select(viesgoBegasaSipscoFormatDateDF.col(\"cups\"), viesgoBegasaSipscoFormatDateDF.col(\"finicio\"), viesgoBegasaSipscoFormatDateDF.col(\"ffin\"), viesgoBegasaSipscoFormatDateDF.col(\"tarifa\"), viesgoBegasaSipscoFormatDateDF.col(\"consumoactivap1\"), viesgoBegasaSipscoFormatDateDF.col(\"consumoactivap2\"), viesgoBegasaSipscoFormatDateDF.col(\"consumoactivap3\"), viesgoBegasaSipscoFormatDateDF.col(\"consumoactivap4\"), viesgoBegasaSipscoFormatDateDF.col(\"consumoactivap5\"), viesgoBegasaSipscoFormatDateDF.col(\"consumoactivap6\"), viesgoBegasaSipscoFormatDateDF.col(\"consumoreactivap1\"), viesgoBegasaSipscoFormatDateDF.col(\"consumoreactivap2\"), viesgoBegasaSipscoFormatDateDF.col(\"consumoreactivap3\"), viesgoBegasaSipscoFormatDateDF.col(\"consumoreactivap4\"), viesgoBegasaSipscoFormatDateDF.col(\"consumoreactivap5\"), viesgoBegasaSipscoFormatDateDF.col(\"consumoreactivap6\"), viesgoBegasaSipsFinalDF.col(\"potmaxp1\").cast(FloatType), viesgoBegasaSipscoFormatDateDF.col(\"potmaxp2\"), viesgoBegasaSipscoFormatDateDF.col(\"potmaxp3\"), viesgoBegasaSipscoFormatDateDF.col(\"potmaxp4\"), viesgoBegasaSipscoFormatDateDF.col(\"potmaxp5\"), viesgoBegasaSipscoFormatDateDF.col(\"potmaxp6\"), viesgoBegasaSipscoFormatDateDF.col(\"numdias\"), viesgoBegasaSipscoFormatDateDF.col(\"cmd\"))\n                            )\nviesgoBegasaSipscoFinalDF.show(false)\n","user":"anonymous","dateUpdated":"2023-05-23T13:01:16+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"viesgoBegasaSipscoFinalDF: org.apache.spark.sql.DataFrame = [cups: string, finicio: string ... 22 more fields]\n+----------------------+--------+--------+------+---------------+---------------+---------------+---------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+--------+--------+--------+--------+--------+--------+-------+-----------+\n|cups                  |finicio |ffin    |tarifa|consumoactivap1|consumoactivap2|consumoactivap3|consumoactivap4|consumoactivap5|consumoactivap6|consumoreactivap1|consumoreactivap2|consumoreactivap3|consumoreactivap4|consumoreactivap5|consumoreactivap6|potmaxp1|potmaxp2|potmaxp3|potmaxp4|potmaxp5|potmaxp6|numdias|cmd        |\n+----------------------+--------+--------+------+---------------+---------------+---------------+---------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+--------+--------+--------+--------+--------+--------+-------+-----------+\n|ES0027460000008537RX0F|20160311|20160410|003   |614000.0       |0.0            |0.0            |0.0            |0.0            |0.0            |775000.0         |0.0              |0.0              |null             |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |29     |21172.414  |\n|ES0027460000008562WN0F|20170305|20170404|001   |37000.0        |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |29     |1275.862   |\n|ES0027460000008592AL0F|20160707|20160806|001   |273000.0       |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |30     |9100.0     |\n|ES0027460000008598GW0F|20151202|20160101|004   |136000.0       |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |30     |4533.3335  |\n|ES0027460000008599GA0F|20160210|20160309|001   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |28     |0.0        |\n|ES0027460000008602GY0F|20151202|20160101|001   |236000.0       |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |30     |7866.6665  |\n|ES0027460000008611GS0F|20170411|20170510|001   |393000.0       |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |29     |13551.725  |\n|ES0027460000008498EV0F|20160901|20160930|003   |1.2928E7       |0.0            |0.0            |0.0            |0.0            |0.0            |3791000.0        |0.0              |0.0              |0.0              |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |29     |445793.1   |\n|ES0027460000008532RM0F|20171001|20171031|017   |4.16328992E8   |0.0            |0.0            |0.0            |0.0            |0.0            |2.9601E7         |0.0              |0.0              |6096000.0        |0.0              |0.0              |2500.0  |0.0     |0.0     |0.0     |0.0     |0.0     |30     |1.3877633E7|\n|ES0027460000008584AB0F|20160701|20160731|003   |1095000.0      |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |303000.0         |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |30     |36500.0    |\n|ES0027460000008631MN0F|20170307|20170406|001   |29000.0        |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |29     |1000.0     |\n|ES0027460000008668FA0F|20170511|20170610|004   |146000.0       |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |30     |4866.6665  |\n|ES0027460000008682FV0F|20150607|20150706|003   |3000.0         |0.0            |0.0            |0.0            |0.0            |0.0            |0.0              |0.0              |0.0              |null             |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |29     |103.44827  |\n|ES0027460000008684FL0F|20170311|20170410|004   |555000.0       |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |29     |19137.932  |\n|ES0027460000008763BY0F|20151111|20151204|001   |0.0            |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |23     |0.0        |\n|ES0027460000008764BF0F|20170405|20170504|004   |80000.0        |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |29     |2758.6206  |\n|ES0027460000008767BX0F|20151104|20151203|001   |261000.0       |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |29     |9000.0     |\n|ES0027460000008770BJ0F|20160304|20160403|001   |72000.0        |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |29     |2482.7585  |\n|ES0027460000008771BZ0F|20150608|20150704|001   |59000.0        |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |26     |2269.2307  |\n|ES0027460000008771BZ0F|20170307|20170406|001   |107000.0       |0.0            |0.0            |0.0            |0.0            |0.0            |null             |0.0              |0.0              |null             |0.0              |0.0              |null    |0.0     |0.0     |0.0     |0.0     |0.0     |29     |3689.6553  |\n+----------------------+--------+--------+------+---------------+---------------+---------------+---------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+--------+--------+--------+--------+--------+--------+-------+-----------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1684686582681_-237199861","id":"20230521-182942_1418300461","dateCreated":"2023-05-21T18:29:42+0200","dateStarted":"2023-05-23T13:01:16+0200","dateFinished":"2023-05-23T13:01:19+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4197"},{"text":"%spark\n//check the schema and the type of data\nviesgoBegasaSipscoFinalDF.printSchema","user":"anonymous","dateUpdated":"2023-05-23T13:01:51+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- cups: string (nullable = true)\n |-- finicio: string (nullable = true)\n |-- ffin: string (nullable = true)\n |-- tarifa: string (nullable = true)\n |-- consumoactivap1: float (nullable = true)\n |-- consumoactivap2: float (nullable = false)\n |-- consumoactivap3: float (nullable = false)\n |-- consumoactivap4: float (nullable = false)\n |-- consumoactivap5: float (nullable = false)\n |-- consumoactivap6: float (nullable = false)\n |-- consumoreactivap1: float (nullable = true)\n |-- consumoreactivap2: float (nullable = false)\n |-- consumoreactivap3: float (nullable = false)\n |-- consumoreactivap4: float (nullable = true)\n |-- consumoreactivap5: float (nullable = false)\n |-- consumoreactivap6: float (nullable = false)\n |-- potmaxp1: float (nullable = true)\n |-- potmaxp2: float (nullable = false)\n |-- potmaxp3: float (nullable = false)\n |-- potmaxp4: float (nullable = false)\n |-- potmaxp5: float (nullable = false)\n |-- potmaxp6: float (nullable = false)\n |-- numdias: integer (nullable = false)\n |-- cmd: float (nullable = true)"}]},"apps":[],"jobName":"paragraph_1684686434795_619476296","id":"20230521-182714_893975772","dateCreated":"2023-05-21T18:27:14+0200","dateStarted":"2023-05-23T13:01:51+0200","dateFinished":"2023-05-23T13:01:52+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4198"},{"text":"%md\n##Creation of query tables in Hive for SIPS, SIPSCO and contracts\n","user":"anonymous","dateUpdated":"2023-05-22T21:10:57+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1684695347376_1196875272","id":"20230521-205547_1861032399","dateCreated":"2023-05-21T20:55:47+0200","dateStarted":"2023-05-22T21:10:57+0200","dateFinished":"2023-05-22T21:10:57+0200","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4199"},{"text":"%md\n### Creation of SIPS and SIPSCO tables in Hive for the electrical distributors inside a database called silver_database","user":"anonymous","dateUpdated":"2023-05-23T13:05:33+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Creation of SIPS and SIPSCO tables in Hive for the electrical distributors inside a database called silver_database</h3>\n"}]},"apps":[],"jobName":"paragraph_1684839720152_-1099760592","id":"20230523-130200_2097834394","dateCreated":"2023-05-23T13:02:00+0200","dateStarted":"2023-05-23T13:05:33+0200","dateFinished":"2023-05-23T13:05:33+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4200"},{"text":"%sql\nDROP DATABASE IF EXISTS silver_database cascade\n","user":"anonymous","dateUpdated":"2023-05-21T21:03:12+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1684445287215_714618101","id":"20230518-232807_1957984386","dateCreated":"2023-05-18T23:28:07+0200","dateStarted":"2023-05-21T18:55:35+0200","dateFinished":"2023-05-21T18:55:39+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4201"},{"text":"%sql\nCREATE DATABASE IF NOT EXISTS silver_database\n","user":"anonymous","dateUpdated":"2023-05-21T21:03:12+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1684358866034_-1337405621","id":"20230517-232746_767142262","dateCreated":"2023-05-17T23:27:46+0200","dateStarted":"2023-05-21T18:55:57+0200","dateFinished":"2023-05-21T18:55:58+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4202"},{"text":"%sql\nUSE silver_database","user":"anonymous","dateUpdated":"2023-05-23T13:03:33+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1684358922818_-1012457303","id":"20230517-232842_729279230","dateCreated":"2023-05-17T23:28:42+0200","dateStarted":"2023-05-23T13:03:34+0200","dateFinished":"2023-05-23T13:03:41+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4203"},{"text":"%spark\n//Creation of the Hive table for contracts\ncontractsDF.write.mode(\"overwrite\").saveAsTable(\"contracts\")","user":"anonymous","dateUpdated":"2023-05-23T13:05:54+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1684516912365_-482427957","id":"20230519-192152_440164974","dateCreated":"2023-05-19T19:21:52+0200","dateStarted":"2023-05-23T13:03:56+0200","dateFinished":"2023-05-23T13:03:58+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4204"},{"text":"%spark\n//Creation of the cnmc_sipsco Hive table \ncnmcSipscoFinalDF.write.mode(\"overwrite\").saveAsTable(\"cnmc_sipsco\")","user":"anonymous","dateUpdated":"2023-05-23T13:06:22+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1684353836555_603412616","id":"20230517-220356_1376452807","dateCreated":"2023-05-17T22:03:56+0200","dateStarted":"2023-05-23T13:03:24+0200","dateFinished":"2023-05-23T13:03:39+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4205"},{"text":"%spark\n//Creation of the cnmc_sips Hive table \ncnmcSipsFinalDF.write.mode(\"overwrite\").saveAsTable(\"cnmc_sips\")","user":"anonymous","dateUpdated":"2023-05-23T13:06:32+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1684446269100_-1082878316","id":"20230518-234429_1947657995","dateCreated":"2023-05-18T23:44:29+0200","dateStarted":"2023-05-23T13:03:49+0200","dateFinished":"2023-05-23T13:03:55+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4206"},{"text":"%spark\n//Creation of the viesgo_begasa_sips Hive table \nviesgoBegasaSipsFinalDF.write.mode(\"overwrite\").saveAsTable(\"viesgo_begasa_sips\")","user":"anonymous","dateUpdated":"2023-05-23T13:06:46+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1684619430499_-878951087","id":"20230520-235030_197259185","dateCreated":"2023-05-20T23:50:30+0200","dateStarted":"2023-05-23T13:04:00+0200","dateFinished":"2023-05-23T13:04:02+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4207"},{"text":"%spark\n//Creation of the viesgo_begasa_sipsco Hive table \nviesgoBegasaSipscoFinalDF.write.mode(\"overwrite\").saveAsTable(\"viesgo_begasa_sipsco\")","user":"anonymous","dateUpdated":"2023-05-23T13:07:04+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1684688177098_1273662767","id":"20230521-185617_1941759560","dateCreated":"2023-05-21T18:56:17+0200","dateStarted":"2023-05-23T13:04:05+0200","dateFinished":"2023-05-23T13:04:12+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4208"},{"text":"%sql\nshow tables","user":"anonymous","dateUpdated":"2023-05-23T13:07:11+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"database":"string","tableName":"string","isTemporary":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"database\ttableName\tisTemporary\nsilver_database\tcnmc_sipsco\tfalse\nsilver_database\tcnmc_sips\tfalse\nsilver_database\tcontracts\tfalse\nsilver_database\tviesgo_begasa_sips\tfalse\nsilver_database\tviesgo_begasa_sipsco\tfalse"}]},"apps":[],"jobName":"paragraph_1684358234447_-512067881","id":"20230517-231714_1822835832","dateCreated":"2023-05-17T23:17:14+0200","dateStarted":"2023-05-23T13:07:11+0200","dateFinished":"2023-05-23T13:07:12+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4209"},{"text":"\n","user":"anonymous","dateUpdated":"2023-05-21T21:06:28+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1684359131405_-1422912805","id":"20230517-233211_2016115932","dateCreated":"2023-05-17T23:32:11+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4210"}],"name":"Caso_practico/silver/Tables_SIPSCO_SIPS_contracts","id":"2HYSJU6M7","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}