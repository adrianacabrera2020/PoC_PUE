{"paragraphs":[{"text":"%md\n#### This notebook reads txt files for supply poins (ps) for EDP and extracts information into data frames","user":"anonymous","dateUpdated":"2023-05-23T13:08:38+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>This notebook reads txt files for supply poins (ps) for EDP and extracts information into data frames</h4>\n"}]},"apps":[],"jobName":"paragraph_1684840072868_441248564","id":"20230523-130752_1507836098","dateCreated":"2023-05-23T13:07:52+0200","dateStarted":"2023-05-23T13:08:38+0200","dateFinished":"2023-05-23T13:08:38+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2212"},{"text":"%spark\nimport org.apache.spark.sql.{SparkSession, DataFrame}\nimport org.apache.spark.sql.functions.{udf, col}\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.Row\nimport spark.implicits._\n\nimport java.sql.Timestamp\nimport java.text.SimpleDateFormat","user":"anonymous","dateUpdated":"2023-05-22T16:31:11+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.{SparkSession, DataFrame}\nimport org.apache.spark.sql.functions.{udf, col}\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.Row\nimport spark.implicits._\nimport java.sql.Timestamp\nimport java.text.SimpleDateFormat"}]},"apps":[],"jobName":"paragraph_1684752391055_-327784154","id":"20230522-124631_1122950018","dateCreated":"2023-05-22T12:46:31+0200","dateStarted":"2023-05-22T16:31:11+0200","dateFinished":"2023-05-22T16:31:14+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2213"},{"text":"%md\n##Supply point for Hidrocantabrico \n","user":"anonymous","dateUpdated":"2023-05-22T11:24:50+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Supply point for Hidrocantabrico</h2>\n"}]},"apps":[],"jobName":"paragraph_1684747458024_-172508621","id":"20230522-112418_1764526294","dateCreated":"2023-05-22T11:24:18+0200","dateStarted":"2023-05-22T11:24:50+0200","dateFinished":"2023-05-22T11:24:51+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2214"},{"text":"%spark\n//Paths of FormatoFicheroSuministros.txt for the format of supply point files and the one of the supply point files (HIDROCANTABRICO_PS_03140_001.TXT)  \nval formartPsPathRaw = \"/user/training/adriana/raw/EDP/Formatos/FormatoFicheroSuministros.txt\"\nval edpPsPath001Raw = \"/user/training/adriana/raw/EDP/HIDROCANTABRICO_PS/HIDROCANTABRICO_PS_03140_001.TXT\"","user":"anonymous","dateUpdated":"2023-05-23T13:14:14+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"formartPsPathRaw: String = /user/training/adriana/raw/EDP/Formatos/FormatoFicheroSuministros.txt\nedpPsPath001Raw: String = /user/training/adriana/raw/EDP/HIDROCANTABRICO_PS/HIDROCANTABRICO_PS_03140_001.TXT"}]},"apps":[],"jobName":"paragraph_1684749808848_1517098305","id":"20230522-120328_539653203","dateCreated":"2023-05-22T12:03:28+0200","dateStarted":"2023-05-23T13:14:14+0200","dateFinished":"2023-05-23T13:14:15+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2215"},{"text":"%spark\n//Load the format ps file\n//Trying to use proper encoding\nval formartPsDF = spark.read.option(\"encoding\", \"iso-8859-1\").text(formartPsPathRaw)\n","user":"anonymous","dateUpdated":"2023-05-23T13:15:52+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"formartPsDF: org.apache.spark.sql.DataFrame = [value: string]"}]},"apps":[],"jobName":"paragraph_1684749884958_2046479149","id":"20230522-120444_1188838394","dateCreated":"2023-05-22T12:04:44+0200","dateStarted":"2023-05-23T13:15:52+0200","dateFinished":"2023-05-23T13:15:53+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2216"},{"text":"%spark\n//Reads file FormatoFicheroSuministros.txt and returns a list of tuples with name columns for HIDROCANTABRICO_PS as first element and number of chars as second element of the tuple\nval linesFormartPs = spark.read.option(\"header\", \"false\").text(formartPsPathRaw).as[String].collect().toList\nval regex = \"\"\"^(.*?)\\((\\d+)\\)$\"\"\".r\nval newLinesFormartPs = linesFormartPs.map {\n  case regex(text, number) => (text.trim, number.toInt)\n  case _ => (\"\", 0)\n}\n\nprintln(newLinesFormartPs)\n","user":"anonymous","dateUpdated":"2023-05-23T13:17:07+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"linesFormartPs: List[String] = List(Punto de suministro(10), CUPS(22), Empresa distribuidora(54), Ubicaci�n PS(81), Poblaci�n_Codigo PS(14), Provincia(2), Fecha de alta(8), Tarifa en vigor(5), Tensi�n(10), Potencia M�xima Bolet�n(10), Potencia M�xima APM(10), Tipo Punto Medida(2), Disponibilidad ICP(1), Tipo Perfil Consumo(1), Derechos Extensi�n(10), Derechos Acceso(10), Propiedad Equipo Medida(1), Propiedad ICP(1), Potencias Contratada 1(10), Potencias Contratada 2(10), Potencias Contratada 3(10), Potencias Contratada 4(10), Potencias Contratada 5(10), Potencias Contratada 6(10), Potencias Contratada 7(10), Fecha Ultimo Movimiento de Contratacion(8), Fecha Ultimo Cambio de Comercializador(8), Fecha l�mite derechos extensi�n(8), Fecha ultima lectura(8), Tipo de interlocutor(1), Nombre I...regex: scala.util.matching.Regex = ^(.*?)\\((\\d+)\\)$\nnewLinesFormartPs: List[(String, Int)] = List((Punto de suministro,10), (CUPS,22), (Empresa distribuidora,54), (Ubicaci�n PS,81), (Poblaci�n_Codigo PS,14), (Provincia,2), (Fecha de alta,8), (Tarifa en vigor,5), (Tensi�n,10), (Potencia M�xima Bolet�n,10), (Potencia M�xima APM,10), (Tipo Punto Medida,2), (Disponibilidad ICP,1), (Tipo Perfil Consumo,1), (Derechos Extensi�n,10), (Derechos Acceso,10), (Propiedad Equipo Medida,1), (Propiedad ICP,1), (Potencias Contratada 1,10), (Potencias Contratada 2,10), (Potencias Contratada 3,10), (Potencias Contratada 4,10), (Potencias Contratada 5,10), (Potencias Contratada 6,10), (Potencias Contratada 7,10), (Fecha Ultimo Movimiento de Contratacion,8), (Fecha Ultimo Cambio de Comercializador,8), (Fecha l�mite derechos extensi�n,8), (Fecha ultima lectur...List((Punto de suministro,10), (CUPS,22), (Empresa distribuidora,54), (Ubicaci�n PS,81), (Poblaci�n_Codigo PS,14), (Provincia,2), (Fecha de alta,8), (Tarifa en vigor,5), (Tensi�n,10), (Potencia M�xima Bolet�n,10), (Potencia M�xima APM,10), (Tipo Punto Medida,2), (Disponibilidad ICP,1), (Tipo Perfil Consumo,1), (Derechos Extensi�n,10), (Derechos Acceso,10), (Propiedad Equipo Medida,1), (Propiedad ICP,1), (Potencias Contratada 1,10), (Potencias Contratada 2,10), (Potencias Contratada 3,10), (Potencias Contratada 4,10), (Potencias Contratada 5,10), (Potencias Contratada 6,10), (Potencias Contratada 7,10), (Fecha Ultimo Movimiento de Contratacion,8), (Fecha Ultimo Cambio de Comercializador,8), (Fecha l�mite derechos extensi�n,8), (Fecha ultima lectura,8), (Tipo de interlocutor,1), (Nombre IC,80), (Ubicaci�n IC,81), (Poblaci�n IC,12), (C�digo postal,10), (Provincia,3), (vivienda habitual,1), (Dep�sito garant�a,13), (Deuda,1), (Telegestionado,2), (SuministroContratable,1), (Fases,1), (Autoconsumo,2), (Codigo de Comercializadora,4), (Indicador Bono social,1))"}]},"apps":[],"jobName":"paragraph_1684750247088_-1956312321","id":"20230522-121047_2068130048","dateCreated":"2023-05-22T12:10:47+0200","dateStarted":"2023-05-23T13:16:28+0200","dateFinished":"2023-05-23T13:16:31+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2217"},{"text":"%spark\n//Load the data txt file\n//Trying to use proper encoding\nval edpPs001DF = spark.read.option(\"encoding\", \"iso-8859-1\").text(edpPsPath001Raw)\nedpPs001DF.printSchema","user":"anonymous","dateUpdated":"2023-05-23T13:17:44+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"edpPs001DF: org.apache.spark.sql.DataFrame = [value: string]\nroot\n |-- value: string (nullable = true)"}]},"apps":[],"jobName":"paragraph_1684747212800_-1140804980","id":"20230522-112012_439205455","dateCreated":"2023-05-22T11:20:12+0200","dateStarted":"2023-05-23T13:17:44+0200","dateFinished":"2023-05-23T13:17:46+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2218"},{"text":"%spark\n//Get the list of tuples and convert it into a list of substrings of the form (value, position in the line, number of chars)\nvar startPosition = 1\n  val mapLines = newLinesFormartPs.map { case (colName, size) =>\n  val newSubstring = substring(col(\"value\"), startPosition, size).alias(colName)\n  startPosition += size \n  newSubstring\n}","user":"anonymous","dateUpdated":"2023-05-23T13:22:57+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"startPosition: Int = 1\nmapLines: List[org.apache.spark.sql.Column] = List(substring(value, 1, 10) AS `Punto de suministro`, substring(value, 11, 22) AS `CUPS`, substring(value, 33, 54) AS `Empresa distribuidora`, substring(value, 87, 81) AS `Ubicaci�n PS`, substring(value, 168, 14) AS `Poblaci�n_Codigo PS`, substring(value, 182, 2) AS `Provincia`, substring(value, 184, 8) AS `Fecha de alta`, substring(value, 192, 5) AS `Tarifa en vigor`, substring(value, 197, 10) AS `Tensi�n`, substring(value, 207, 10) AS `Potencia M�xima Bolet�n`, substring(value, 217, 10) AS `Potencia M�xima APM`, substring(value, 227, 2) AS `Tipo Punto Medida`, substring(value, 229, 1) AS `Disponibilidad ICP`, substring(value, 230, 1) AS `Tipo Perfil Consumo`, substring(value, 231, 10) AS `Derechos Extensi�n`, substring(value, 241, 10) AS ..."}]},"apps":[],"jobName":"paragraph_1684777545346_-1690814932","id":"20230522-194545_1928875467","dateCreated":"2023-05-22T19:45:45+0200","dateStarted":"2023-05-23T13:22:57+0200","dateFinished":"2023-05-23T13:22:59+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2219"},{"text":"%spark\n//apply the mapLines function to the edpPs001DF data frame\nval edpPs001NewDF = edpPs001DF.select(mapLines: _*)\nedpPs001NewDF.show(false)\n","user":"anonymous","dateUpdated":"2023-05-23T13:25:23+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"edpPs001NewDF: org.apache.spark.sql.DataFrame = [Punto de suministro: string, CUPS: string ... 42 more fields]\n+-------------------+----------------------+--------------------------------------------------------+---------------------------------------------------------------------------------+-------------------+---------+-------------+---------------+----------+-----------------------+-------------------+-----------------+------------------+-------------------+------------------+---------------+-----------------------+-------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+---------------------------------------+--------------------------------------+-------------------------------+--------------------+--------------------+--------------------------------------------------------------------------------+---------------------------------------------------------------------------------+------------+-------------+---------+-----------------+-----------------+-----+--------------+---------------------+-----+-----------+--------------------------+---------------------+\n|Punto de suministro|CUPS                  |Empresa distribuidora                                   |Ubicaci�n PS                                                                     |Poblaci�n_Codigo PS|Provincia|Fecha de alta|Tarifa en vigor|Tensi�n   |Potencia M�xima Bolet�n|Potencia M�xima APM|Tipo Punto Medida|Disponibilidad ICP|Tipo Perfil Consumo|Derechos Extensi�n|Derechos Acceso|Propiedad Equipo Medida|Propiedad ICP|Potencias Contratada 1|Potencias Contratada 2|Potencias Contratada 3|Potencias Contratada 4|Potencias Contratada 5|Potencias Contratada 6|Potencias Contratada 7|Fecha Ultimo Movimiento de Contratacion|Fecha Ultimo Cambio de Comercializador|Fecha l�mite derechos extensi�n|Fecha ultima lectura|Tipo de interlocutor|Nombre IC                                                                       |Ubicaci�n IC                                                                     |Poblaci�n IC|C�digo postal|Provincia|vivienda habitual|Dep�sito garant�a|Deuda|Telegestionado|SuministroContratable|Fases|Autoconsumo|Codigo de Comercializadora|Indicador Bono social|\n+-------------------+----------------------+--------------------------------------------------------+---------------------------------------------------------------------------------+-------------------+---------+-------------+---------------+----------+-----------------------+-------------------+-----------------+------------------+-------------------+------------------+---------------+-----------------------+-------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+---------------------------------------+--------------------------------------+-------------------------------+--------------------+--------------------+--------------------------------------------------------------------------------+---------------------------------------------------------------------------------+------------+-------------+---------+-----------------+-----------------+-----+--------------+---------------------+-----+-----------+--------------------------+---------------------+\n|0010091165         |ES0026000010091165MT0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04060300     |1  00          |00000220  |    5,00               |    0,0005         |SA               |                  |                   |    4,40          |    4,40DD     |                       |             |    4,40              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |17070720                               |17070799                              |99123120                       |171206J             |                    |                                                                                |                                                                               C0|311300      |        03   | N       |                 |      24,27N0    |2    |1M            |0                    |0    |08         |600                       |                     |\n|0010091166         |ES0026000010091166MR0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04012600     |1  00          |00000230  |    8,80               |    0,0005         |SA               |                  |                   |    9,20          |    8,80TD     |                       |             |    9,20              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |13110420                               |09102120                              |17051320                       |140511F             |                    |                                                                                |                                                                                 |            |        03   | S       |                 |      48,54S0    |3    |1             |0                    |0    |           |  0                       |                     |\n|0010091167         |ES0026000010091167MW0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04012600     |1  00          |00000220  |    8,80               |    0,0005         |SA               |                  |                   |    8,80          |    8,80DD     |                       |             |    8,80              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                       |171206F             |                    |                                                                                |                                                                                 |            |        03   | S       |                 |      48,54N0    |2    |1M            |0                    |0    |06         |420                       |                     |\n|0010091168         |ES0026000010091168MA0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04012600     |1  00          |00000220  |    8,80               |    0,0005         |SA               |                  |                   |    3,30          |    3,30DD     |                       |             |    3,30              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |17122720                               |17122799                              |99123120                       |171227F             |                    |                                                                                |                                                                               C0|307600      |        03   | S       |                 |      18,20N0    |2    |1M            |0                    |0    |09         |270                       |                     |\n|0010091169         |ES0026000010091169MG0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04012600     |1  00          |00000220  |    8,80               |    0,0005         |SA               |                  |                   |    8,80          |    8,80DD     |                       |             |    8,80              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                       |171206F             |                    |                                                                                |                                                                                 |            |        CV   | S       |                 |      48,54N0    |2    |1M            |0                    |0    |06         |420                       |                     |\n|0010091170         |ES0026000010091170MM0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04012600     |1  00          |00000230  |    8,80               |    0,0005         |SA               |                  |                   |    8,80          |    8,80DD     |                       |             |    9,20              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |15062720                               |15062799                              |99123120                       |171206F             |                    |                                                                                |                                                                                 |            |        03   | S       |                 |      48,54N0    |2    |1M            |0                    |0    |00         |860                       |                     |\n|0010091261         |ES0026000010091261DG0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04012600     |1  00          |00000230  |    8,80               |    0,0005         |SA               |                  |                   |    8,05          |    8,05DD     |                       |             |    8,05              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09062699                              |99123120                       |171206F             |                    |                                                                                |                                                                                 |            |        03   | S       |                 |      58,49N0    |2    |1M            |0                    |0    |00         |860                       |                     |\n|0010091262         |ES0026000010091262DM0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04012700     |1  00          |00000230  |    8,80               |    0,0005         |NA               |                  |                   |    5,75          |    5,75D      |                       |             |    5,75              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |11082799                              |99123120                       |171206F             |                    |                                                                                |                                                                               C0|307600      |        03   | S       |                 |      18,20N0    |2    |1M            |0                    |0    |00         |860                       |                     |\n|0010091263         |ES0026000010091263DY0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04012600     |1  00          |00000220  |    8,80               |    0,0005         |SA               |                  |                   |    8,80          |    8,80DD     |                       |             |    8,80              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                       |171206F             |                    |                                                                                |                                                                                 |            |        SY   | S       |                 |      48,54N0    |2    |0M            |0                    |0    |06         |420                       |                     |\n|0010091264         |ES0026000010091264DF0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04012100     |1  00          |00000230  |    8,80               |    0,0005         |SA               |                  |                   |    3,45          |    3,45DD     |                       |             |    3,45              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |16060720                               |16060799                              |99123120                       |171206F             |                    |                                                                                |                                                                               C0|307600      |        03   | S       |                 |      48,54N0    |2    |1M            |0                    |0    |07         |250                       |                     |\n|0010091266         |ES0026000010091266DD0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04030200     |1  00          |00000220  |    8,80               |    0,0005         |SA               |                  |                   |    5,50          |    5,50DD     |                       |             |    5,50              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                       |171206F             |                    |                                                                                |                                                                                 |            |        03   | S       |                 |      30,34N0    |2    |1M            |0                    |0    |06         |420                       |                     |\n|0010091267         |ES0026000010091267DX0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04012900     |1  00          |00000220  |    8,80               |    0,0005         |SA               |                  |                   |    5,50          |    5,50DD     |                       |             |    5,50              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                       |171206F             |                    |                                                                                |                                                                               C0|307600      |        03   | S       |                 |      30,34N0    |2    |1M            |0                    |0    |06         |420                       |                     |\n|0010091268         |ES0026000010091268DB0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04030200     |1  00          |00000230  |    8,80               |    0,0005         |SA               |                  |                   |    5,75          |    5,75TD     |                       |             |    5,75              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |13110420                               |09070120                              |15061820                       |120617F             |                    |                                                                                |                                                                               C0|307600      |        03   | S       |                 |      26,41S0    |3    |1             |0                    |0    |           |  0                       |                     |\n|0010091269         |ES0026000010091269DN0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04012900     |1  00          |00000230  |    8,80               |    0,0005         |SA               |                  |                   |    5,75          |    5,75DD     |                       |             |    5,75              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                       |171206F             |                    |                                                                                |                                                                                 |            |        03   | S       |                 |      30,34N0    |2    |1M            |0                    |0    |06         |420                       |                     |\n|0010091271         |ES0026000010091271DZ0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04012900     |1  00          |00000230  |    8,80               |    0,0005         |NA               |                  |                   |    5,75          |    5,75D      |                       |             |    5,75              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |15112620                               |15112799                              |99123120                       |171206F             |                    |                                                                                |                                                                               C0|307600      |        03   | S       |                 |      30,89N0    |2    |1M            |0                    |0    |00         |860                       |                     |\n|0010091272         |ES0026000010091272DS0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04012900     |1  00          |00000220  |    8,80               |    0,0005         |SA               |                  |                   |    5,50          |    5,50DD     |                       |             |    5,50              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                       |171206F             |                    |                                                                                |                                                                               C0|307600      |        03   | S       |                 |      30,34N0    |2    |1M            |0                    |0    |06         |420                       |                     |\n|0010091273         |ES0026000010091273DQ0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04012900     |1  00          |00000220  |    8,80               |    0,0005         |SA               |                  |                   |    5,50          |    5,50DD     |                       |             |    5,50              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                       |171206F             |                    |                                                                                |                                                                               C0|307600      |        03   | S       |                 |      30,34N0    |2    |1M            |0                    |0    |06         |420                       |                     |\n|0010091274         |ES0026000010091274DV0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04012900     |1  00          |00000220  |    8,80               |    0,0005         |SA               |                  |                   |    5,50          |    5,50DD     |                       |             |    5,50              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                       |171206F             |                    |                                                                                |                                                                               C0|307600      |        03   | S       |                 |      30,34N0    |2    |1M            |0                    |0    |06         |420                       |                     |\n|0010091275         |ES0026000010091275DH0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |04030200     |1  00          |00000220  |    8,80               |    0,0005         |SA               |                  |                   |    5,50          |    5,50DD     |                       |             |    5,50              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                       |171206F             |                    |                                                                                |                                                                               C0|307600      |        03   | S       |                 |      30,34N0    |2    |1M            |0                    |0    |06         |420                       |                     |\n|0010091277         |ES0026000010091277DC0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003     |20       |05011300     |1  00          |00000230  |    8,80               |    0,0005         |NA               |                  |                   |    5,75          |    5,75D      |                       |             |    5,75              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |16083120                               |16083199                              |99123120                       |171206F             |                    |                                                                                |                                                                               C0|307600      |        03   | S       |                 |      30,89N0    |2    |1M            |0                    |0    |09         |270                       |                     |\n+-------------------+----------------------+--------------------------------------------------------+---------------------------------------------------------------------------------+-------------------+---------+-------------+---------------+----------+-----------------------+-------------------+-----------------+------------------+-------------------+------------------+---------------+-----------------------+-------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+---------------------------------------+--------------------------------------+-------------------------------+--------------------+--------------------+--------------------------------------------------------------------------------+---------------------------------------------------------------------------------+------------+-------------+---------+-----------------+-----------------+-----+--------------+---------------------+-----+-----------+--------------------------+---------------------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1684766207621_-2101710407","id":"20230522-163647_650408958","dateCreated":"2023-05-22T16:36:47+0200","dateStarted":"2023-05-23T13:25:23+0200","dateFinished":"2023-05-23T13:25:25+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2220"},{"text":"%spark\n//check the schema\nedpPs001NewDF.printSchema()","user":"anonymous","dateUpdated":"2023-05-23T13:25:34+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Punto de suministro: string (nullable = true)\n |-- CUPS: string (nullable = true)\n |-- Empresa distribuidora: string (nullable = true)\n |-- Ubicaci�n PS: string (nullable = true)\n |-- Poblaci�n_Codigo PS: string (nullable = true)\n |-- Provincia: string (nullable = true)\n |-- Fecha de alta: string (nullable = true)\n |-- Tarifa en vigor: string (nullable = true)\n |-- Tensi�n: string (nullable = true)\n |-- Potencia M�xima Bolet�n: string (nullable = true)\n |-- Potencia M�xima APM: string (nullable = true)\n |-- Tipo Punto Medida: string (nullable = true)\n |-- Disponibilidad ICP: string (nullable = true)\n |-- Tipo Perfil Consumo: string (nullable = true)\n |-- Derechos Extensi�n: string (nullable = true)\n |-- Derechos Acceso: string (nullable = true)\n |-- Propiedad Equipo Medida: string (nullable = true)\n |-- Propiedad ICP: string (nullable = true)\n |-- Potencias Contratada 1: string (nullable = true)\n |-- Potencias Contratada 2: string (nullable = true)\n |-- Potencias Contratada 3: string (nullable = true)\n |-- Potencias Contratada 4: string (nullable = true)\n |-- Potencias Contratada 5: string (nullable = true)\n |-- Potencias Contratada 6: string (nullable = true)\n |-- Potencias Contratada 7: string (nullable = true)\n |-- Fecha Ultimo Movimiento de Contratacion: string (nullable = true)\n |-- Fecha Ultimo Cambio de Comercializador: string (nullable = true)\n |-- Fecha l�mite derechos extensi�n: string (nullable = true)\n |-- Fecha ultima lectura: string (nullable = true)\n |-- Tipo de interlocutor: string (nullable = true)\n |-- Nombre IC: string (nullable = true)\n |-- Ubicaci�n IC: string (nullable = true)\n |-- Poblaci�n IC: string (nullable = true)\n |-- C�digo postal: string (nullable = true)\n |-- Provincia: string (nullable = true)\n |-- vivienda habitual: string (nullable = true)\n |-- Dep�sito garant�a: string (nullable = true)\n |-- Deuda: string (nullable = true)\n |-- Telegestionado: string (nullable = true)\n |-- SuministroContratable: string (nullable = true)\n |-- Fases: string (nullable = true)\n |-- Autoconsumo: string (nullable = true)\n |-- Codigo de Comercializadora: string (nullable = true)\n |-- Indicador Bono social: string (nullable = true)"}]},"apps":[],"jobName":"paragraph_1684759234757_1477874298","id":"20230522-144034_716324877","dateCreated":"2023-05-22T14:40:34+0200","dateStarted":"2023-05-23T13:25:34+0200","dateFinished":"2023-05-23T13:25:35+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2221"},{"text":"%spark\n//Cleaning the column names\nval edpPs001CleanDF = (edpPs001NewDF\n                    .withColumnRenamed(\"Ubicaci�n PS\", \"ubicacion\")\n                    .withColumnRenamed(\"Poblaci�n_Codigo PS\", \"codpoblacion\")\n                    .withColumnRenamed(\"Tensi�n\", \"tension\")\n                    .withColumnRenamed(\"Potencia M�xima Bolet�n\", \"potmaxbie\")\n                    .withColumnRenamed(\"Potencia M�xima APM\", \"potmax1\")\n                    .withColumnRenamed(\"Derechos Extensi�n\", \"derext\")\n                    .withColumnRenamed(\"Fecha l�mite derechos extensi�n\", \"flimite_derechos_extension\")\n                    .withColumnRenamed(\"Poblaci�n IC\", \"poblacion_ic\")\n                    .withColumnRenamed(\"Ubicaci�n IC\", \"ubicacion_ic\")\n                    .withColumnRenamed(\"C�digo postal\", \"codpostal\")\n                    .withColumnRenamed(\"Dep�sito garant�a\", \"deposito_garantia\")\n                )\nedpPs001CleanDF.show(false)","user":"anonymous","dateUpdated":"2023-05-23T13:26:15+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"edpPs001CleanDF: org.apache.spark.sql.DataFrame = [Punto de suministro: string, CUPS: string ... 42 more fields]\n+-------------------+----------------------+--------------------------------------------------------+---------------------------------------------------------------------------------+--------------+---------+-------------+---------------+----------+----------+----------+-----------------+------------------+-------------------+----------+---------------+-----------------------+-------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+---------------------------------------+--------------------------------------+--------------------------+--------------------+--------------------+--------------------------------------------------------------------------------+---------------------------------------------------------------------------------+------------+----------+---------+-----------------+-----------------+-----+--------------+---------------------+-----+-----------+--------------------------+---------------------+\n|Punto de suministro|CUPS                  |Empresa distribuidora                                   |ubicacion                                                                        |codpoblacion  |Provincia|Fecha de alta|Tarifa en vigor|tension   |potmaxbie |potmax1   |Tipo Punto Medida|Disponibilidad ICP|Tipo Perfil Consumo|derext    |Derechos Acceso|Propiedad Equipo Medida|Propiedad ICP|Potencias Contratada 1|Potencias Contratada 2|Potencias Contratada 3|Potencias Contratada 4|Potencias Contratada 5|Potencias Contratada 6|Potencias Contratada 7|Fecha Ultimo Movimiento de Contratacion|Fecha Ultimo Cambio de Comercializador|flimite_derechos_extension|Fecha ultima lectura|Tipo de interlocutor|Nombre IC                                                                       |ubicacion_ic                                                                     |poblacion_ic|codpostal |Provincia|vivienda habitual|deposito_garantia|Deuda|Telegestionado|SuministroContratable|Fases|Autoconsumo|Codigo de Comercializadora|Indicador Bono social|\n+-------------------+----------------------+--------------------------------------------------------+---------------------------------------------------------------------------------+--------------+---------+-------------+---------------+----------+----------+----------+-----------------+------------------+-------------------+----------+---------------+-----------------------+-------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+---------------------------------------+--------------------------------------+--------------------------+--------------------+--------------------+--------------------------------------------------------------------------------+---------------------------------------------------------------------------------+------------+----------+---------+-----------------+-----------------+-----+--------------+---------------------+-----+-----------+--------------------------+---------------------+\n|0010091165         |ES0026000010091165MT0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04060300     |1  00          |00000220  |    5,00  |    0,0005|SA               |                  |                   |    4,40  |    4,40DD     |                       |             |    4,40              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |17070720                               |17070799                              |99123120                  |171206J             |                    |                                                                                |                                                                               C0|311300      |        03| N       |                 |      24,27N0    |2    |1M            |0                    |0    |08         |600                       |                     |\n|0010091166         |ES0026000010091166MR0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04012600     |1  00          |00000230  |    8,80  |    0,0005|SA               |                  |                   |    9,20  |    8,80TD     |                       |             |    9,20              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |13110420                               |09102120                              |17051320                  |140511F             |                    |                                                                                |                                                                                 |            |        03| S       |                 |      48,54S0    |3    |1             |0                    |0    |           |  0                       |                     |\n|0010091167         |ES0026000010091167MW0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04012600     |1  00          |00000220  |    8,80  |    0,0005|SA               |                  |                   |    8,80  |    8,80DD     |                       |             |    8,80              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                  |171206F             |                    |                                                                                |                                                                                 |            |        03| S       |                 |      48,54N0    |2    |1M            |0                    |0    |06         |420                       |                     |\n|0010091168         |ES0026000010091168MA0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04012600     |1  00          |00000220  |    8,80  |    0,0005|SA               |                  |                   |    3,30  |    3,30DD     |                       |             |    3,30              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |17122720                               |17122799                              |99123120                  |171227F             |                    |                                                                                |                                                                               C0|307600      |        03| S       |                 |      18,20N0    |2    |1M            |0                    |0    |09         |270                       |                     |\n|0010091169         |ES0026000010091169MG0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04012600     |1  00          |00000220  |    8,80  |    0,0005|SA               |                  |                   |    8,80  |    8,80DD     |                       |             |    8,80              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                  |171206F             |                    |                                                                                |                                                                                 |            |        CV| S       |                 |      48,54N0    |2    |1M            |0                    |0    |06         |420                       |                     |\n|0010091170         |ES0026000010091170MM0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04012600     |1  00          |00000230  |    8,80  |    0,0005|SA               |                  |                   |    8,80  |    8,80DD     |                       |             |    9,20              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |15062720                               |15062799                              |99123120                  |171206F             |                    |                                                                                |                                                                                 |            |        03| S       |                 |      48,54N0    |2    |1M            |0                    |0    |00         |860                       |                     |\n|0010091261         |ES0026000010091261DG0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04012600     |1  00          |00000230  |    8,80  |    0,0005|SA               |                  |                   |    8,05  |    8,05DD     |                       |             |    8,05              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09062699                              |99123120                  |171206F             |                    |                                                                                |                                                                                 |            |        03| S       |                 |      58,49N0    |2    |1M            |0                    |0    |00         |860                       |                     |\n|0010091262         |ES0026000010091262DM0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04012700     |1  00          |00000230  |    8,80  |    0,0005|NA               |                  |                   |    5,75  |    5,75D      |                       |             |    5,75              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |11082799                              |99123120                  |171206F             |                    |                                                                                |                                                                               C0|307600      |        03| S       |                 |      18,20N0    |2    |1M            |0                    |0    |00         |860                       |                     |\n|0010091263         |ES0026000010091263DY0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04012600     |1  00          |00000220  |    8,80  |    0,0005|SA               |                  |                   |    8,80  |    8,80DD     |                       |             |    8,80              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                  |171206F             |                    |                                                                                |                                                                                 |            |        SY| S       |                 |      48,54N0    |2    |0M            |0                    |0    |06         |420                       |                     |\n|0010091264         |ES0026000010091264DF0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04012100     |1  00          |00000230  |    8,80  |    0,0005|SA               |                  |                   |    3,45  |    3,45DD     |                       |             |    3,45              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |16060720                               |16060799                              |99123120                  |171206F             |                    |                                                                                |                                                                               C0|307600      |        03| S       |                 |      48,54N0    |2    |1M            |0                    |0    |07         |250                       |                     |\n|0010091266         |ES0026000010091266DD0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04030200     |1  00          |00000220  |    8,80  |    0,0005|SA               |                  |                   |    5,50  |    5,50DD     |                       |             |    5,50              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                  |171206F             |                    |                                                                                |                                                                                 |            |        03| S       |                 |      30,34N0    |2    |1M            |0                    |0    |06         |420                       |                     |\n|0010091267         |ES0026000010091267DX0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04012900     |1  00          |00000220  |    8,80  |    0,0005|SA               |                  |                   |    5,50  |    5,50DD     |                       |             |    5,50              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                  |171206F             |                    |                                                                                |                                                                               C0|307600      |        03| S       |                 |      30,34N0    |2    |1M            |0                    |0    |06         |420                       |                     |\n|0010091268         |ES0026000010091268DB0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04030200     |1  00          |00000230  |    8,80  |    0,0005|SA               |                  |                   |    5,75  |    5,75TD     |                       |             |    5,75              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |13110420                               |09070120                              |15061820                  |120617F             |                    |                                                                                |                                                                               C0|307600      |        03| S       |                 |      26,41S0    |3    |1             |0                    |0    |           |  0                       |                     |\n|0010091269         |ES0026000010091269DN0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04012900     |1  00          |00000230  |    8,80  |    0,0005|SA               |                  |                   |    5,75  |    5,75DD     |                       |             |    5,75              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                  |171206F             |                    |                                                                                |                                                                                 |            |        03| S       |                 |      30,34N0    |2    |1M            |0                    |0    |06         |420                       |                     |\n|0010091271         |ES0026000010091271DZ0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04012900     |1  00          |00000230  |    8,80  |    0,0005|NA               |                  |                   |    5,75  |    5,75D      |                       |             |    5,75              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |15112620                               |15112799                              |99123120                  |171206F             |                    |                                                                                |                                                                               C0|307600      |        03| S       |                 |      30,89N0    |2    |1M            |0                    |0    |00         |860                       |                     |\n|0010091272         |ES0026000010091272DS0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04012900     |1  00          |00000220  |    8,80  |    0,0005|SA               |                  |                   |    5,50  |    5,50DD     |                       |             |    5,50              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                  |171206F             |                    |                                                                                |                                                                               C0|307600      |        03| S       |                 |      30,34N0    |2    |1M            |0                    |0    |06         |420                       |                     |\n|0010091273         |ES0026000010091273DQ0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04012900     |1  00          |00000220  |    8,80  |    0,0005|SA               |                  |                   |    5,50  |    5,50DD     |                       |             |    5,50              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                  |171206F             |                    |                                                                                |                                                                               C0|307600      |        03| S       |                 |      30,34N0    |2    |1M            |0                    |0    |06         |420                       |                     |\n|0010091274         |ES0026000010091274DV0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04012900     |1  00          |00000220  |    8,80  |    0,0005|SA               |                  |                   |    5,50  |    5,50DD     |                       |             |    5,50              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                  |171206F             |                    |                                                                                |                                                                               C0|307600      |        03| S       |                 |      30,34N0    |2    |1M            |0                    |0    |06         |420                       |                     |\n|0010091275         |ES0026000010091275DH0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |04030200     |1  00          |00000220  |    8,80  |    0,0005|SA               |                  |                   |    5,50  |    5,50DD     |                       |             |    5,50              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |14082620                               |09070199                              |99123120                  |171206F             |                    |                                                                                |                                                                               C0|307600      |        03| S       |                 |      30,34N0    |2    |1M            |0                    |0    |06         |420                       |                     |\n|0010091277         |ES0026000010091277DC0F|HIDROCANTABRICO DISTRIBUCI�N EL�CTRICA            0026  |                                                                               C0|307600_0314003|20       |05011300     |1  00          |00000230  |    8,80  |    0,0005|NA               |                  |                   |    5,75  |    5,75D      |                       |             |    5,75              |    0,00              |    0,00              |    0,00              |    0,00              |    0,00              |    0,0020            |16083120                               |16083199                              |99123120                  |171206F             |                    |                                                                                |                                                                               C0|307600      |        03| S       |                 |      30,89N0    |2    |1M            |0                    |0    |09         |270                       |                     |\n+-------------------+----------------------+--------------------------------------------------------+---------------------------------------------------------------------------------+--------------+---------+-------------+---------------+----------+----------+----------+-----------------+------------------+-------------------+----------+---------------+-----------------------+-------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+---------------------------------------+--------------------------------------+--------------------------+--------------------+--------------------+--------------------------------------------------------------------------------+---------------------------------------------------------------------------------+------------+----------+---------+-----------------+-----------------+-----+--------------+---------------------+-----+-----------+--------------------------+---------------------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1684766796043_-1896591581","id":"20230522-164636_1148418044","dateCreated":"2023-05-22T16:46:36+0200","dateStarted":"2023-05-23T13:26:15+0200","dateFinished":"2023-05-23T13:26:16+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2222"},{"text":"%spark\n//check for duplicates\nedpPs001CleanDF.count()\nedpPs001CleanDF.dropDuplicates().count()","user":"anonymous","dateUpdated":"2023-05-23T13:26:48+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res293: Long = 2908\nres294: Long = 2908"}]},"apps":[],"jobName":"paragraph_1684777826967_-343304286","id":"20230522-195026_117315938","dateCreated":"2023-05-22T19:50:26+0200","dateStarted":"2023-05-23T13:26:48+0200","dateFinished":"2023-05-23T13:26:53+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2223"},{"text":"%spark\n//...to be continue...\n","user":"anonymous","dateUpdated":"2023-05-23T13:27:23+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1684778680428_-563469581","id":"20230522-200440_479800546","dateCreated":"2023-05-22T20:04:40+0200","dateStarted":"2023-05-23T13:27:23+0200","dateFinished":"2023-05-23T13:27:24+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2224"},{"text":"%spark\n","user":"anonymous","dateUpdated":"2023-05-23T13:27:23+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1684841243665_1714361660","id":"20230523-132723_1733739414","dateCreated":"2023-05-23T13:27:23+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:2225"}],"name":"Caso_practico/silver/ETL_edp","id":"2J342JM13","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}